---
layout: persian
classes: wide rtl-layout
dir: rtl
title: "ุฑูุด ูุง ุชุฌูุน ุฏุฑ ุงุฏฺฏุฑ ูุงุดู"
permalink: /teaching/studenteffort/patterneffort/single_linkage_clustring/
author_profile: true

header:
  overlay_image: "/assets/images/background.jpg"
  overlay_filter: 0.3
  overlay_color: "#5e616c"
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"
---

# ุฑูุดโูุง ุชุฌูุน (Agglomerative Methods) ุฏุฑ ุงุฏฺฏุฑ ูุงุดู
---
<p>

<p> ููุณูุฏู : ุนุฑูุงู ููุณู ูฺุงุฏ</p>
  <a href="mailto:er.mousavinezhad@gmail.com">
er.mousavinezhad@gmail.com  </a>
</p>
<p>
ุฏุงูุดฺฏุงู ูุฑุฏูุณ ูุดูุฏ - ุฏุงูุดฺฉุฏู ูููุฏุณ - ฺฏุฑูู ููุด ูุตููุน
</p>


## ููุฏูู
---
ุฏุฑ ููุฏูู ุงู ููุงูู ู ูพุด ุงุฒ ูุฑูุฏ ุจู ุจุญุซ ุงูฺฏูุฑุชูโูุง ุชุฌูุนุ  ูุงุฒู ุงุณุช ุงุจุชุฏุง ููุงูู ูพุงูโุง ุฏุฑ ุชฺฉูฺฉโูุง ุฎูุดูโุจูุฏ ุฑุง ุฏุฑฺฉ ฺฉูู. ุจูุงุจุฑุงูุ ุงุจุชุฏุง ุจู ููููู ุฎูุดูโุจูุฏ (Clustering)  ุฏุฑ ุงุฏฺฏุฑ ูุงุดู ูโูพุฑุฏุงุฒู:
"ุฎูุดูโุจูุฏ ูุฌููุนูโุง ฺฏุณุชุฑุฏู ุงุฒ ุฑูุดโูุงุณุช ฺฉู ูุฏู ุขู ุงูุชู ุฒุฑฺฏุฑููโูุง ุง ุฎูุดูโูุง ุฏุฑ ุฏุงุฏูโูุงุณุชุ ุจูโฺฏูููโุง ฺฉู ุงุนุถุง ูุฑ ุฎูุดู ุงุฒ ูุธุฑ ูฺฺฏโูุง ุง ูุดุฎุตูโูุง ุฏุฑููโุฏุงุฏูโุง ุจู ฺฉุฏฺฏุฑ ุดุจู ุจุงุดูุฏุ ุงูุง ุจุง ุงุนุถุง ุฎูุดูโูุง ุฏฺฏุฑ ุชูุงูุช ุฏุงุดุชู ุจุงุดูุฏ."
ุงุตู ุงุณุงุณ ุฏุฑ ุฎูุดูโุจูุฏ ุงู ุงุณุช ฺฉู ุฏุงุฏูโูุง ููุฌูุฏ ุฏุฑูู ฺฉ ุฎูุดู ุจุงุฏ ุชุง ุญุฏ ููฺฉู ุจุดุชุฑู ุดุจุงูุช ุฑุง ุจุง ฺฉุฏฺฏุฑ ุฏุงุดุชู ุจุงุดูุฏ ู ุฏุฑ ููุงุจูุ ุฏุงุฏูโูุง ุฎุงุฑุฌ ุงุฒ ุขู ุฎูุดู ุจุงุฏ ุจุดุชุฑู ุชูุงูุช ุฑุง ูุณุจุช ุจู ุงุนุถุง ุขู ุฏุงุดุชู ุจุงุดูุฏ.
ุญุงู ฺฉู ุจุง ุฏุณุชูโุจูุฏ ฺฉู ููุถูุน ุขุดูุง ูพุฏุง ฺฉุฑุฏูุ ุฎูุจ ุงุณุช ุจุฏุงูู ฺฉู ุฏุฑ ููุถูุน ุงูฺฏูุฑุชูโูุง ุชุฌูุนุ ุฏู ุฏุณุชู ฺฉู ุงูฺฏูุฑุชู ูุทุฑุญ ุงุณุช:
-	ุงูฺฏูุฑุชูโูุง ุจุฑ ูพุงู ูุงุชุฑุณ: ุฏุฑ ุงู ููุน ุงูฺฏูุฑุชูุ ุฏุงุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุงุชุฑุณ ูุงุตูู (Distance Matrix) ุง ูุงุชุฑุณ ุชุดุงุจู (Similarity Matrix) ููุงุด ุฏุงุฏู ูโุดููุฏ. ุงู ูุงุชุฑุณ ูุนูููุง ูุฑุจุน ุงุณุช ู ุงูุฏุงุฒูโ ุขู ุจุฑุง n ุฏุงุฏูุ ฺฉ ูุงุชุฑุณ (n x n) ุงุณุช ฺฉู ุฏุฑ ุฎุงููโ (i, j)ุ ูุงุตูู ู ุง ุดุจุงูุช ุจู ูููููโ i ู j ูุญุงุธ ูโุดูุฏ.

-	ุงูฺฏูุฑุชูโูุง ุจุฑ ูพุงู ฺฏุฑุงู: ุฏุฑ ุงู ููุน ุงูฺฏูุฑุชูุ ุฏุงุฏูโูุง ุจุตูุฑุช ฺฏุฑูโูุง (nodes) ุฏุฑ ฺฉ ฺฏุฑุงู ููุงุด ุฏุงุฏู ูโุดููุฏ ู ุงูโูุง (edges) ุจู ูุฑ ฺฏุฑูุ ุจุงูฺฏุฑ ูุฒุงู ุชุดุงุจู ุง ูุงุตูู ุจู ุขููุง ูุณุชูุฏ. ุฏุฑ ุงู ุงูฺฏูุฑุชูุ ุจู ุฌุง ฺฉุงุฑ ุจุฑ ุฑู ูุงุชุฑุณ ูุงุตููุ ูุณุชููุง ุจุฑ ุฑู ุณุงุฎุชุงุฑ ฺฏุฑุงู ุงุนูุงู ูโุดูุฏ.
ุฏุฑ ุงู ููุงููุ ุชูุฑฺฉุฒ ุจุฑ ุฑู ุงูฺฏูุฑุชูโูุง ุจุฑ ูพุงู ูุงุชุฑุณ ุฎูุงูุฏ ุจูุฏ.


## ุชุนุฑู ุชุฆูุฑ ูุงุชุฑุณ ุจุง ฺฉ ูุซุงู
---
ูุงุชุฑุณ ุฒุฑ ฺฉู ูุฑุชุจุท ุจุง 5 ููุทู ุฏุฑ ุตูุญู ุฏฺฉุงุฑุช ูุณุชูุฏ ุฑุง ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ:

| Sample | X   | Y   |
| ------ | --- | --- |
| P1     | 1   | 1   |
| P2     | 2   | 1   |
| P3     | 5   | 4   |
| P4     | 6   | 5   |
| P5     | 6.5 | 6   |

ููุงูุทูุฑ ฺฉู ุงุญุชูุงูุง ูุฏุงูุฏุ ูุงุตูู ุงููุฏุณ (Euclidean Distance) ุจุฑุง ุฏู ููุทู ุฏุฑ ุตูุญู ุฏฺฉุงุฑุช ุจู ูุณูู ูุฑููู ุฒุฑ ูุญุงุณุจู ูโุดูุฏ:

$$ d( (x_1,y_1), (x_2,y_2)) = \sqrt{(x_1-x_2)^2 + (y_1-y_2)^2} $$

ุจุง ุชูุฌู ุงู ูุฑูููุ ูุงุตูู ูุฑ ููุทู ุจุง ููุทู ุฏฺฏุฑ ูุญุงุณุจู ู ุฏุงุฎู ูุงุชุฑุณ P(x) ูุฑุงุฑ ูฺฏุฑุฏ. ุจุฏู ุงุณุช ฺฉู ูุงุตููโ ูุฑ ููุทู ุชุง ุฎูุฏุด (ูุทุฑ ุงุตู ูุงุชุฑุณ) ูููุงุฑู ุตูุฑ ุงุณุช. ุฏุฑ ููุงุชุ ูุงุชุฑุณ ูุงุตูู ุจุฑุง ุงู ุฏุงุฏูโูุง ฺฏูุชู ุดุฏู ุจู ุดฺฉู ุฒุฑ ุฏุฑ ุฎูุงูุฏ ุขูุฏ:

$$
P(X) = 
\begin{bmatrix}
0 & 1 & 5 & 6.4 & 7.4 \\
1 & 0 & 4.2 & 5.7 & 6.7 \\
5 & 4.2 & 0 & 1.4 & 2.5 \\
6.4 & 5.7 & 1.4 & 0 & 1.1 \\
7.4 & 6.7 & 2.5 & 1.1 & 0 \\
\end{bmatrix}
$$

## ุฏูุฏุฑูฺฏุฑุงู (Dendrogram)
---
ูููุฏุงุฑ ุฏูุฏุฑูฺฏุฑุงู (Dendrogram) ฺฉู ุณุงุฎุชุงุฑ ุฏุฑุฎุชโูุงููุฏ ุฏุงุฑุฏุ ุฑูุด ููุซุฑ ุจุฑุง ููุงุด ุชูุงู ุฎูุดูโูุง ุงุณุช ฺฉู ุชูุณุท ฺฉ ุงูฺฏูุฑุชู ุชุฌูุน ุชููุฏ ูโุดููุฏ. ุฏุฑ ุงู ุณุงุฎุชุงุฑ:
-	ูุฑ ุด (ุฏุงุฏู ูููุฑุฏ) ุจุง ฺฉ ฺฏุฑู ุจุฑฺฏ (leaf node)  ููุงุด ุฏุงุฏู ูโุดูุฏ.
-	ูุฑ  ุฎูุดู (ฺฉู ุงุฒ ุงุฏุบุงู ฺูุฏ ุฏุงุฏู ุง ุฎูุดู ฺฉูฺฺฉุชุฑ ุชุดฺฉู ุดุฏู ุงุณุช) ุจุง ฺฉ ฺฏุฑู ุฑุดู (root node) ูุดุงู ุฏุงุฏู ูโุดูุฏ.
ุจู ุจุงู ุฏฺฏุฑุ ุฏูุฏุฑูฺฏุฑุงู ุจู ูุง ูุดุงู ูโุฏูุฏ ฺฉู ฺู ููุงุทุ ุฏุฑ ฺู ูุฑุงุญู ู ุจุง ฺู ูุฒุงู ุดุจุงูุช ุจุง ฺฉุฏฺฏุฑ ุงุฏุบุงู ุดุฏูโุงูุฏ. ุฏุฑ ูุณูุช ูพุงูุ ุฏุฑุฎุช ุฏุงุฏูโูุง ูููุฑุฏ ูุฑุงุฑ ุฏุงุฑูุฏ ู ุจุง ุจุงูุง ุฑูุชู ุงุฒ ุฏุฑุฎุชุ ุฎูุดูโูุง ุจุฒุฑฺฏโุชุฑ ุญุงุตู ุงุฒ ุงุฏุบุงูโูุง ูพโุฏุฑโูพ ููุงุด ุฏุงุฏู ูโุดููุฏ.
ุฏูุฏุฑูฺฏุฑุงู ูุงุชุฑุณ ุชูุงูุช ุจุฑุง ุฏุงุฏูโูุง ุจุงูุง ุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:

<img src="/assets/patterneffort/linkage/img-00.png" alt="Dendrogram">

## ุงูฺฏูุฑุชูโูุง ุชุฌูุน ุจุฑ ูพุงู ุชุฆูุฑ ูุงุชุฑุณ โ ูุชุฏ ุงุชุตุงู ูุฌุฑุฏ (Single Link Method)
---

ุฏุฑ ุขูุงุฑุ ุฎูุดูโุจูุฏ ุงุชุตุงู ูุฌุฑุฏ ฺฉ ุงุฒ ฺูุฏู ุฑูุดู ุฎูุดูโุจูุฏ ุณูุณููโูุฑุงุชุจ ุงุณุช. ุงู ุฑูุด ุจุฑ ูพุงู ฺฏุฑููโุจูุฏ ุฎูุดูโูุง ุจู ุดูู ูพุงู ุจู ุจุงูุง (ุฎูุดูโุจูุฏ ุชุฌูุน) ุงุณุชูุงุฑ ุงุณุชุ ุจูโุทูุฑ ฺฉู ุฏุฑ ูุฑ ฺฏุงูุ ุฏู ุฎูุดูโุง ุจุง ฺฉุฏฺฏุฑ ุงุฏุบุงู ูโุดููุฏ ฺฉู ุฏุงุฑุง ูุฒุฏฺฉโุชุฑู ุฒูุฌ ุงุฒ ุนูุงุตุฑ ุจุงุดูุฏุ ุจู ุดุฑุท ฺฉู ุขู ุฏู ุนูุตุฑ ูููุฒ ุจู ฺฉ ุฎูุดู ุชุนูู ูุฏุงุดุชู ุจุงุดูุฏ. ุฏุฑ ุงู ุญุงูุชุ ูุงุตูู ุจู ุฏู ฺฏุฑูู $ C_i $ู $ C_j $ุจุฑุงุจุฑ ุงุณุช ุจุง ูุงุตูู ุจู ูุฒุฏฺฉโุชุฑู ุงุนุถุง ุขู ุฏู ฺฏุฑูู:

$$ d(C_i, C_j) = min[d(x_k, x_l)], x_k \in C_i, x_l \in C_j $$

ุงู ุฑูุด ุชูุงู ุฏุงุฑุฏ ุฎูุดูโูุง ุจุงุฑฺฉ ู ุฏุฑุงุฒ ุชููุฏ ฺฉูุฏ ฺฉู ุฏุฑ ุขูโูุง ุนูุงุตุฑ ูุฌุงูุฑู ุฏุฑูู ฺฉ ุฎูุดูุ ูุงุตููโุง ุงูุฏฺฉ ุฏุงุฑูุฏุ ุงูุง ุนูุงุตุฑ ูุงูุน ุฏุฑ ุฏู ุงูุชูุง ฺฉ ุฎูุดู ููฺฉู ุงุณุช ูุงุตููโุง ุจุณุงุฑ ุจุดุชุฑ ุงุฒ ุฏู ุนูุตุฑ ูุชุนูู ุจู ุฎูุดูโูุง ุฏฺฏุฑ ุงุฒ ฺฉุฏฺฏุฑ ุฏุงุดุชู ุจุงุดูุฏ. ุจุฑุง ุจุฑุฎ ุงุฒ ุฏุงุฏู ูุงุ ุงู ูฺฺฏ ูโุชูุงูุฏ ุจู ุงุฌุงุฏ ูุดฺฉูุงุช ุฏุฑ ุชุนุฑู ฺฉูุงุณโูุง ฺฉู ุจุชูุงููุฏ ุฏุงุฏู ุฑุง ุจู ุดฺฉู ุฏุฑุณุช ุชูุณู ุจูุฏ ฺฉูุฏุ ุจูุฌุงูุฏ. ุจุง ุงู ุญุงูุ ุงู ุฑูุด ุฏุฑ ุงุฎุชุฑุดูุงุณ ุจุฑุง ุชุญูู ุฎูุดูโูุง ฺฉูฺฉุดุงู - ฺฉู ุงุบูุจ ููฺฉู ุงุณุช ุดุงูู ุฑุดุชูโูุง ุฏุฑุงุฒ ุงุฒ ูุงุฏู ุจุงุดูุฏ - ูพุฑุทุฑูุฏุงุฑ ุงุณุช. ุฏุฑ ุงู ุญูุฒู ฺฉุงุฑุจุฑุฏุ ุงู ุงูฺฏูุฑุชู ุจุง ูุงู ุงูฺฏูุฑุชู ุฏูุณุชุงูู ุฏูุณุชุงู (friends-of-friends) ูุฒ ุดูุงุฎุชู ูโุดูุฏ.

<img src="/assets/patterneffort/linkage/img-01.jpg" alt="Dendrogram">

### ูุชุฏ ุงุชุตุงู ูุฌุฑุฏ โ ูุซุงู
---
ูุฑุถ ฺฉูุฏ ูุงุชุฑุณ ูุงุตูู ุจู ุฑูุด ุงููุฏุณ ุจุฑุง 6 ููุทู ุจุตูุฑุช ุฒุฑ ุงุณุช:

$$
\begin{array}{c|ccccc}
 & 1 & 2 & 3 & 4 & 5 & 6 \\ \hline
1 & 0 & 4 & 13 & 24 & 12 & 8 \\
2 &   & 0 & 10 & 22 & 11 & 10 \\
3 &   &   & 0 & 7 & 3 & 9 \\
4 &   &   &   & 0 & 6 & 18 \\
5 &   &   &   &   & 0 & 8.5 \\
6 &   &   &   &   &   &  0
\end{array}
$$

ุญุงู ูุฑุงุฑ ุงุณุช ฺฉู ุจุง ุชูุฌู ุจู ูุฑููู ุงุชุตุงู ูุฌุฑุฏุ ุฏุงุฏูโูุง ฺฉู ฺฉูุชุฑู ูุงุตูู ุจุง ฺฉุฏฺฏุฑ ุฑุง ุฏุงุฑูุฏุ ุชุดฺฉู ฺฉ ุฎูุดู ุจุฏููุฏ. ุฏุฑ ุงู ูุซุงูุ ฺฏุฑูู ุฌุฏุฏ ุจู ุฏุงุฏูโูุง 3 ู 5 ุณุงุฎุชู ูโุดูุฏุ ุฒุฑุง ููุฏุงุฑ ูุงุตูู ุจุฑุง ุงู ุฏู ุฏุงุฏู ููุฏุงุฑ ฺฉููู (ุนุฏุฏ 3) ูโุจุงุดุฏ:

$$
\begin{array}{c|ccccc}
 & 1 & 2 & 3 & 4 & 5 & 6 \\ \hline
1 & 0 & 4 & 13 & 24 & 12 & 8 \\
2 &   & 0 & 10 & 22 & 11 & 10 \\
3 &   &   & 0 & 7 & \textcircled{3} & 9 \\
4 &   &   &   & 0 & 6 & 18 \\
5 &   &   &   &   & 0 & 8.5 \\
6 &   &   &   &   &   &  0
\end{array}
$$

ุฏุฑ ุงู ูุฑุญููุ ูุงุตููโูุง ุจู ฺฏุฑูู ุฌุฏุฏ ู ุณุงุฑ ฺฏุฑููโูุง ุจู ุดฺฉู ุฒุฑ ูุญุงุณุจู ูโุดูุฏ:

\( d_{1,(3,5)} = \min\{d_{13}, d_{15}\} = 12 \)
\( d_{2,(3,5)} = \min\{d_{23}, d_{25}\} = 10 \)
\( d_{4,(3,5)} = \min\{d_{43}, d_{45}\} = 6 \)
\( d_{6,(3,5)} = \min\{d_{63}, d_{65}\} = 8.5 \)

ุฏุฑ ุงู ูุฑุญููุ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุงุชุฑุณ ุฌุฏุฏ ุชููุฏ ุดุฏูุ ูุฌุฏุฏ ูุฑุงุญู ุฑุง ุชฺฉุฑุงุฑ ูฺฉูู:

$$
\begin{array}{c|ccccc}
 & 1 & 2 & (3,5) & 4 & 6 \\ \hline
1 & 0 & \textcircled{4} & 12 & 24 & 8 \\
2 &   & 0 & 10 & 22 & 10 \\
(3,5) &   &   & 0 & 6 & 8.5 \\
4 &   &   &   & 0 & 18 \\
6 &   &   &   &   & 0
\end{array}
$$

ฺฉู ุชุดฺฉู ฺูุงุฑ ฺฉูุงุณ (1 ู 2)ุ (3 ู 5)ุ 4 ู 6 ูุฏููุฏ:

\( d_{(1,2) ,(3,5)} = \min\{d_{13}, d_{23}, d_{15}, d_{25}\} = 10 \)
\( d_{(1,2) ,4} = \min\{d_{14}, d_{24}\} = 22 \)

ุฏุฑ ูุฑุญูู ุจุนุฏุ ูุงุชุฑุณ ูุงุตูู ุฌุฏุฏ ุจู ุดฺฉู ุฒุฑ ุฏุฑ ุฎูุงูุฏ ุขูุฏ:

$$
\begin{array}{c|ccccc}
 & (1,2) & (3,5) & 4 & 6 \\ \hline
(1,2) & 0 & 10 & 22 & 8  \\
(3,5) &   & 0 & \enclose{circle}{6} & 8.5 \\
4 &   &   & 0 & 18 \\
6 &   &   &   & 0
\end{array}
$$

ุงุฏุงูู ูุฏูู:

$$
\begin{array}{c|ccccc}
 & (1,2) & (3,4,5)  & 6 \\ \hline
(1,2) & 0 & 10 &  \enclose{circle}{8}  \\
(3,4,5) &   & 0 & 8.5 \\
6 &   &   & 0
\end{array}
$$

ู ุฏุฑ ุขุฎุฑู ูุฑุญูู ุฎูุงูู ุฏุงุดุช:

$$
\begin{array}{c|ccccc}
 & (1,2,6) & (3,4,5)  \\ \hline
(1,2,6) & 0 &  \enclose{circle}{8.5}  \\
(3,4,5) &   & 0 \\
\end{array}
$$

ุฏูุฏุฑูฺฏุฑุงู ุงู ุฏุงุฏูโูุง ุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:

<img src="/assets/patterneffort/linkage/img-02.jpg" alt="Dendrogram">

ุงูฺฏูุฑุชู ุชุฌูุน ูพุดู ุฏุฑ ุฑูุด ุงุชุตุงู ูุฌุฑุฏ (single-link) ูุดุงู ูโุฏูุฏ ฺฉู ุจุฑุง ุงุชุตุงู ุฏู ฺฏุฑูู ูุฌุฒุงุ ุชููุง ูุฌูุฏ ฺฉ ูพููุฏ ฺฉุงู ุงุณุช. ุฏุฑ ุงู ุฑูุดุ ูุงุตููโ ูุงู ุฏู ฺฏุฑูู ุจุฑุงุจุฑ ุงุณุช ุจุง ูุงุตููโ ูุฒุฏฺฉโุชุฑู ุงุนุถุง ุขูโูุง. ุจู ููู ุฏููุ ุงู ุฑูุด ุฑุง **ุฑูุด ูุฒุฏฺฉโุชุฑู ููุณุงฺฏุงู** ูุฒ ูโูุงููุฏ.

## ุงูฺฏูุฑุชูโูุง ุชุฌูุน ุจุฑ ูพุงู ุชุฆูุฑ ูุงุชุฑุณ โ ูุชุฏ ุงุชุตุงู ฺฉุงูู (Complete Link Method)
---
ุงู ุฑูุด ูู ุจุณุงุฑ ุดุจู ุจู ูุชุฏ ูุจู ุงุณุช ุจุง ุงู ุชูุงูุช ฺฉู ุฏุฑ ุงู ุฑูุดุ ูุนุงุฑ ุงุชุตุงู ููุงุท ุจู ุดฺฉู ุฒุฑ ุชุนุฑู ูโุดูุฏ:

$$ d(C_q, C_s) = max[d(C_i, C_s), d(C_j, C_s)] $$

ุงู ุฑูุด ููฺูู ุจุง ูุงู ุฑูุด ุฏูุฑุชุฑู ููุณุงฺฏุงู ูุฒ ุดูุงุฎุชู ูโุดูุฏ. ุฏุฑ ุงู ุฑูุดุ ูุงุตููโ ุจู ุฏู ฺฏุฑูู $ C_i $ ู $ C_j $ ุจุฑุงุจุฑ ุงุณุช ุจุง ูุงุตููโ ุจู ุฏูุฑุชุฑู ููุงุท ุจู ุทูุฑ ฺฉู ูุฑ ููุทู ุงุฒ ฺฉ ุงุฒ ุฏู ฺฏุฑูู ุงูุชุฎุงุจ ูโุดููุฏ:

$$ d(C_i, C_j) = max[d(x_k, x_l)], x_k \in C_i, x_l \in C_j  $$

ุชูุฌู ุจู ุงู ูฺฉุชู ุญุงุฆุฒ ุงููุช ุงุณุช ฺฉู ุฏุฑ ุชุฑุณู ูููุฏุงุฑ ุฏูุฏุฑูฺฏุฑุงู ุฏุฑ ุฑูุด ุงุชุตุงู ูุฌุฑุฏุ ุฎูุดูโูุง ุจุงุฑฺฉ ู ุจููุฏ ุงุฌุงุฏ ูโุดููุฏ ุฏุฑ ุญุงูฺฉู ุฏุฑ ุฑูุด ุงุชุตุงู ฺฉุงููุ ุฎูุดูโูุง ุจุตูุฑุช ูุดุฑุฏู ู ูุงุถุญุชุฑ ุฑุณู ุฎูุงููุฏ ุดุฏ.


## ูพุงุฏู ุณุงุฒ ุจู ุฒุจุงู ูพุงุชูู
---

ุญุงู ูุฎูุงูู ูุซุงู ุจุงูุง ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูพุงุชูู ูพุงุฏู ุณุงุฒ ฺฉุฑุฏู ู ุจุตุฑ ุณุงุฒ ุฑุง ุงูุฌุงู ุฏูู. ูพุด ุงุฒ ุงูุฌุงู ฺฉุงูู ุงู ฺฉุงุฑุ ุงุจุชุฏุง ุชูุงู ฺฉุชุงุจุฎุงููโูุง ู ุชูุงุจุน ฺฉู ููุฑุฏ ูุงุฒ ุงุณุช ุจุทูุฑ ุฌุฏุงฺฏุงูู ุจุฑุฑุณ ูโุดููุฏ ู ุณูพุณ ุจู ูพุงุฏูโุณุงุฒ ูุซุงููุง ุฎูุงูู ุฑุณุฏ.

### ุชุงุจุน pdist

ุชุงุจุน `pdist` ฺฉ ุงุฒ ุงุจุฒุงุฑูุง ูพุงูโุง ู ุจุณุงุฑ ููู ุฏุฑ ุฎูุดูโุจูุฏ ู ุชุญูู ูุงุตููโูุง ุฏุฑ ูพุงุชูู ุงุณุช ฺฉู ุฏุฑ ฺฉุชุงุจุฎุงูู `SciPy` ูพุงุฏูโุณุงุฒ ุดุฏู ุงุณุช. ุงู ุชุงุจุน ุฏุฑ `scipy.spatial.distance` ูุฑุงุฑ ุฏุงุฑุฏ ู ูุฎูู pairwise distance (ุจู ูุนู ูุงุตููโูุง ุฏูุชุง) ูโุจุงุดุฏ. ุฏุฑ ุงู ุชุงุจุนุ ูุชูุงู ูพุงุฑุงูุชุฑ `metric` ุฑุง ุจูุง ุจุฑ ูุชุฏ ูุญุงุณุจู ูุงุตูู ููุฑุฏ ูุงุฒ (ูุงููุฏ ุงููุฏุณ ู ...) ุชูุธู ฺฉุฑุฏ.

```python
import numpy as np
from scipy.spatial.distance import pdist

X = np.array([
    [0, 0],
    [1, 2],
])
Y = pdist(X, metric='euclidean')
```

ุฎุฑูุฌ ูุงุชุฑุณ Yุ ูุญุงุณุจู ูุงุตูู ุฏู ููุทู (1, 1) ู (0, 0) ุจู ุฑูุด ุงููุฏุณ ุงุณุช ฺฉู ุจู ุดฺฉู ุฒุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ:

```
array([2.23606798])
```

### ุชุงุจุน linkage

ุชุงุจุน `linkage` ูุฌุฏุฏุง ุงุฒ ฺฉุชุงุจุฎุงูู `SciPy` ฺฉ ุงุฒ ุงุตูุชุฑู ุงุจุฒุงุฑูุง ุจุฑุง ุงุฌุฑุง ุฎูุดูโุจูุฏ ุณูุณูู ูุฑุงุชุจ ุชุฌูุน ูโุจุงุดุฏ:

```python
from scipy.cluster.hierarchy import linkage
```

ุงู ุชุงุจุนุ ูุฑุงุญู ุฎูุดูโุจูุฏ ุฑุง ูุฑุญูู ุจู ูุฑุญูู ุงูุฌุงู ูโุฏูุฏุ ุนู ุงุฒ ูุฑ ุฏุงุฏู ุจู ุนููุงู ฺฉ ุฎูุดู ุดุฑูุน ฺฉุฑุฏู ู ุฏุฑ ูุฑ ูุฑุญููุ ุฏู ุฎูุดู ูุฒุฏฺฉ ุจู ูู ุฑุง ุจุง ูู ุงุฏุบุงู (merge) ูโฺฉูุฏ ุชุง ุฏุฑ ููุงุช ฺฉ ุฎูุดู ูุงุญุฏ ุจุฏุณุช ุขุฏ.

ูุฑู ฺฉู ุงู ุชุงุจุน ุจู ุดฺฉู ุฒุฑ ุงุณุช:

```python
Z = linkage(y, method='single', metric='euclidean', optimal_ordering=False)
```

ุชูุถุญ ุฑุงุฌุน ุจู ูพุงุฑุงูุชุฑูุง ุงู ุชุงุจุน ุฏุฑ ุฌุฏูู ุฒุฑ ุขูุฑุฏู ุดุฏู ุงุณุช:

| ูพุงุฑุงูุชุฑ            | ุชูุถุญ                                             |
| ------------------ | ------------------------------------------------- |
| `y`                | ุฏุงุฏูโูุง (ุขุฑุงูโ ูฺฺฏโูุง ุง ูุงุตููโูุง)                |
| `method`           | ุฑูุด ุงุฏุบุงู ุฎูุดูโูุง                                  |
| `metric`           | ููุน ูุงุตูู (ุฏุฑ ุตูุฑุช ฺฉู `y` ุฏุงุฏูโ ุงุตู ุจุงุดุฏ)       |
| `optimal_ordering` | ุฏุฑ ุตูุฑุช Trueุ ุชุฑุชุจ ููุงุด ุฏูุฏุฑูฺฏุฑุงู ุจูููโุชุฑ ูโุดูุฏ |

ูุซุงู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุงู ุชุงุจุน ุฏุฑ ุฒุฑ ุงุฑุงุฆู ุดุฏู ุงุณุช:

```python
import numpy as np
from scipy.cluster.hierarchy import linkage, dendrogram
import matplotlib.pyplot as plt

# ุฏุงุฏูโ ููููู
X = np.array([
    [1, 2],
    [2, 1],
    [3, 3],
    [6, 5],
    [7, 6]
])

# ุงุฌุฑุง ุฎูุดูโุจูุฏ
Z = linkage(X, method='single', metric='euclidean')

# ููุงุด ุฎุฑูุฌ Z
print(Z)
```

ุฎุฑูุฌ ุงู ฺฉุฏ ุจู ุดฺฉู ุฒุฑ ุฎูุงูุฏ ุจูุฏ:



ุงู ุชุงุจุน ฺฉ ูุงุชุฑุณ ุจู ุดฺฉู $ 4 \times (1-n) $ ุจุฑูฺฏุฑุฏุงูุฏฺฉู ูุฑ ุณุทุฑ ุขูุ ูุดุงู ุฏููุฏู ฺฉ ูุฑุญูู ุงุฏุบุงู ุงุณุช:

| ุณุชูู     | ูุนูุง                                 |
| -------- | ------------------------------------ |
| `Z[i,0]` | ุดูุงุฑูโ ุฎูุดูโ ุงูู ุงุฏุบุงูโุดุฏู            |
| `Z[i,1]` | ุดูุงุฑูโ ุฎูุดูโ ุฏูู ุงุฏุบุงูโุดุฏู            |
| `Z[i,2]` | ูุงุตููโ ุจู ุงู ุฏู ุฎูุดู               |
| `Z[i,3]` | ุชุนุฏุงุฏ ููุงุท ุฏุฑ ุฎูุดูโ ุฌุฏุฏ ูพุณ ุงุฒ ุงุฏุบุงู |

ฺฉ ุงุฒ ุงุตูโุชุฑู ูพุงุฑุงูุชุฑูุง ุงู ุชุงุจุนุ method ุงุณุช ฺฉู ุฏุฑ ููุฑุฏ ุฏู ุชุง ุงุฒ ุขููุง ูพุดุชุฑ ุตุญุจุช ุดุฏ. ุฏุฑ ุฌุฏูู ุฒุฑุ ูุฌุฏุฏ ูุฑูุฑ ุจุฑ ููุงุฑุฏ ฺฏูุชู ุดุฏู ุฏุงุฑู ู ุจุงู ฺฏุฒููโูุง ุฑุง ูุนุฑู ูโฺฉูู:

| ููุฏุงุฑ        | ุชูุถุญ                                           |
| ------------ | ----------------------------------------------- |
| `'single'`   | ฺฉูุชุฑู ูุงุตูู ุจู ุงุนุถุง ุฏู ุฎูุดู (single linkage) |
| `'complete'` | ุจุดุชุฑู ูุงุตูู ุจู ุงุนุถุง                          |
| `'average'`  | ูุงูฺฏู ูุงุตูู ุจู ุงุนุถุง                          |
| `'ward'`     | ฺฉูููโุณุงุฒ ูุงุฑุงูุณ ุฏุงุฎู ุฎูุดูโูุง                   |
| `'centroid'` | ูุงุตูู ุจู ูุฑุงฺฉุฒ ุฎูุดูโูุง                          |
| `'median'`   | ูุดุงุจู centroid ูู ููุงุณ ูุชูุงูุช ุฏุงุฑุฏ            |


### ุชุงุจุน dendrogram

ููุงูุทูุฑ ฺฉู ุงุฒ ุงุณู ุงู ุชุงุจุน ูุดุฎุต ุงุณุชุ ุงู ุชุงุจุน ุจุฑุง ุฑุณู ูููุฏุงุฑ ุฏูุฏุฑูฺฏุฑุงู ุงุณุชูุงุฏู ูโุดูุฏ ู ููุงููุฏ ุชูุงุจุน ูุจูุ ุฏุฑ ฺฉุชุงุจุฎุงูู SciPy ุชุนุฑู ุดุฏู ุงุณุช. ุงู ุชุงุจุน ุฏุฑ ูุงูุน ฺฉ ุฏฺฉุดูุฑ ุจุฑูฺฏุฑุฏุงูุฏ ฺฉู ุญุงู ุงุทูุงุนุงุช ุฑุณู ูููุฏุงุฑ ุฏูุฏุฑูฺฏุฑุงู ุงุณุช.

```python
from scipy.cluster.hierarchy import dendrogram
```

ุฏุฑ ูุทุนู ฺฉุฏ ูพุงูุ ูุซุงู ุงุฒ ุงุณุชูุงุฏู ุงุฒ ุงู ุชุงุจุน ุขูุฑุฏู ุดุฏู ุงุณุช:

```python
from scipy.cluster.hierarchy import linkage, dendrogram
import matplotlib.pyplot as plt

Z = linkage(X, method='single')
dendrogram(Z)
plt.show()
```

### ุชุงุจุน inconsistent

ุดุงุฏ ุจุฑุงุชุงู ุณูุงู ุดุฏู ุจุงุดุฏ ฺฉู ุจุง ฺฉูฺฉ ฺู ุงุจุฒุงุฑ ูโุชูุงู ุงุฒ ุฏุฑุณุช ุฎูุดูโุจูุฏ ุชุง ุญุฏ ูุทูุฆู ุดุฏ. ุจู ุฌูุช ุงุทููุงู ูุณุจ ุงุฒ ุงู ุฑูุดุ ุจุญุซ Inconsistency ูุทุฑุญ ูโุดูุฏ. ูุง ุจู ฺฉูฺฉ ุงู ุชุงุจุนุ ูุฏุฑุช ุง ุถุนู ุงุฏุบุงู ุฏุฑ ุฎูุดูโูุง ุฏุฑ ุฏูุฏุฑูฺฏุฑุงู ุฑุง ุจุฑุฑุณ ูโฺฉูู.
ุจุทูุฑ ฺฉู ูุฑููู ูุญุงุณุจู ุงู ููุฏุงุฑ ุจู ุดฺฉู ุฒุฑ ุงุณุช:

$$ inconsistancy = \frac{d - \mu}{\sigma} $$

ฺฉู ุฏุฑ ุขู:
- $ d $: ูุงุตูู ุฏุฑ ฺฏุฑู ูุนู (ุงุฏุบุงู ุฌุงุฑ)
- $ \mu $: ูุงูฺฏู ูุงุตููโูุง ุงุฏุบุงูโูุง ุฒุฑู (ูุฑุฒูุฏุงู ุขู ฺฏุฑู)
- $ \sigma $: ุงูุญุฑุงู ูุนุงุฑ ูุงุตููโูุง ุงุฏุบุงูโูุง ุฒุฑู

ุจูุงุจุฑุงู ุงฺฏุฑ $ ๐ $ ุฎู ุจุฒุฑฺฏโุชุฑ ุงุฒ $ ๐ $ุ ููุฏุงุฑ inconsistency ุจุงูุง ุงุณุช.

ุฏุฑ ุฎูุดูโุจูุฏ ุณูุณูู ูุฑุงุชุจุ ูุฑ ูุฑุญูู ุงุฒ ุงุฏุบุงู ุจู ุฏู ุฎูุดู ุฏุฑ ุงุฑุชูุงุน ุฎุงุต ุงูุฌุงู ูโุดูุฏ. ุชุงุจุน `inconsistent` ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุงู ุงุฏุบุงู ุณุงุฒฺฏุงุฑ (consistent) ุงุณุช ุง ูุงุณุงุฒฺฏุงุฑ (inconsistent)ุ ุจู ุงู ุตูุฑุช ฺฉู ุงฺฏุฑ ุงุฏุบุงู ูุนู ุฎู ุจุฒุฑฺฏุชุฑ ุงุฒ ูุงูฺฏู ูุงุตููโูุง ุงุฏุบุงูโูุง ูพุงูโุชุฑ ุจุงุดุฏุุงุฏุบุงู "ูุงุณุงุฒฺฏุงุฑ" ุงุณุชุ ุนู ุงุญุชูุงูุง ุฏู ุฎูุดู ูุชูุงูุช ุจุง ฺฉุฏฺฏุฑ ุชุฑฺฉุจ ุดุฏูโุงูุฏ.

ุชุงุจุน `inconsistent` ูู ุจู ูุงููุฏ ุชูุงุจุน ูุจู ุฏุฑ ฺฉุชุงุจุฎุงูู SciPy ุชุนุฑู ุดุฏู ุงุณุช. ูุฑู ฺฉู ุงุณุชูุงุฏู ุงุฒ ุขู ูุฒ ุฏุฑ ูพุงู ุขูุฑุฏู ุดุฏู ุงุณุช:

```python
from scipy.cluster.hierarchy import inconsistent

R = inconsistent(Z, depth=2)
```

ุชูุฌู ุดูุฏ ฺฉู Z ููุงู ุฎุฑูุฌ ุชุงุจุน `linkage` ุงุณุช ฺฉู ูพุดุชุฑ ุชูุถุญ ุฏุงุฏู ุดุฏ.
ูพุงุฑุงูุชุฑ `depth` ูุฒ ุจุงู ูโฺฉูุฏ ฺฉู ุชุง ฺู ุชุนุฏุงุฏ ุณุทุญ ูพุงูโุชุฑ ุฏุฑ ูุญุงุณุจู ูุงุณุงุฒฺฏุงุฑ ูุญุงุธ ุดูุฏ.

ุฎุฑูุฌ ุชุงุจุน inconsistent ูุฒ ุดุจู ุจู ุชุงุจุน `linkage` ูโุจุงุดุฏ. ุงู ุชุงุจุน ฺฉ ุขุฑุงู $ 4 \times (1-n) $ ุจุฑูฺฏุฑุฏุงูุฏ ฺฉู ูุฑ ุณุทุญ ุขู ูุฑุชุจุท ุจุง ฺฉ ูุฑุญูู ุงุฒ ุงุฏุบุงู ุงุณุช:

| ุณุชูู      | ูุนูุง                                                       |
| --------- | ---------------------------------------------------------- |
| `R[i, 0]` | ูุงูฺฏู ุงุฑุชูุงุน ุงุฏุบุงูโูุง ุฒุฑุฎูุดูโูุง                          |
| `R[i, 1]` | ุงูุญุฑุงู ูุนุงุฑ ุงุฑุชูุงุนโูุง ุฒุฑุฎูุดูโูุง                           |
| `R[i, 2]` | ุชุนุฏุงุฏ ุงุฏุบุงูโูุง ฺฉู ุจุฑุง ูุญุงุณุจู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏูุฏ           |
| `R[i, 3]` | ููุฏุงุฑ inconsistency ูุนู: $ ((Z[i,2] - R[i,0]) / R[i,1]) $ |

ุญุงู ุจุงุฏ ุจู ุชูุณุฑ ููุงุฏุฑ ุงู ูุนุงุฑ ุจูพุฑุฏุงุฒู. ุงุฏุบุงู ุณุงุฒฺฏุงุฑ ุง ูุงุณุงุฒฺฏุงุฑ ุฑุง ูโุชูุงู ุงุฒ ููุฏุงุฑ ุฎุฑูุฌ ุงู ุชุงุจุน ูุดุฎุต ฺฉุฑุฏ ฺฉู ุฏุฑ ุฌุฏูู ุฒุฑ ุจุทูุฑ ุฎูุงุตู ุชูุถุญ ุฏุงุฏู ุดุฏู ุงุณุช:

| ููุฏุงุฑ inconsistency | ุชูุณุฑ                                                              |
| ------------------- | ------------------------------------------------------------------ |
| < 1.0               | ุงุฏุบุงู **ุณุงุฒฺฏุงุฑ** ุงุณุช (ุฎูุดูโูุง ุดุจูโุงูุฏ)                              |
| 1.0 โ 2.0           | ุงุฏุบุงู ูุณุจุชุงู ุทุจุน ุงุณุช                                              |
| > 2.0               | ุงุฏุบุงู **ูุงุณุงุฒฺฏุงุฑ** ุงุณุช โ ุงุญุชูุงูุงู ุฎูุดูโูุง ูุชูุงูุช ุจุง ูู ุชุฑฺฉุจ ุดุฏูโุงูุฏ |

ูพุณ ุจุทูุฑ ฺฉูุ ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน `inconsistent` ูโุชูุงู ูููุฏ ฺฉู ฺฉุฏุงู ุจุฎุด ุงุฒ ุฏูุฏุฑูฺฏุฑุงู ูุนูโุฏุงุฑุชุฑ ุงุณุช.


### ุชุงุจุน fcluster

ุชุงุจุน fcluster ุงุณุชูุงุฏู ูโุดูุฏ ุชุง ุงุฒ ุฑู ูุชุฌู linkageุ ุฎูุดูโูุง ููุง ุฑุง ุงุณุชุฎุฑุงุฌ ฺฉูุฏ. ุจู ุนุจุงุฑุช ุฏฺฏุฑ:

- `linkage` ููุท ุณุงุฎุชุงุฑ ุฏุฑุฎุช ุฑุง ูโุณุงุฒุฏ
- ูู `fcluster` ูุดุฎุต ูโฺฉูุฏ ฺฉู ูุฑ ุฏุงุฏู ุจู ฺฉุฏุงู ุฎูุดู ุชุนูู ุฏุงุฑุฏ.

```python
from scipy.cluster.hierarchy import fcluster

clusters = fcluster(Z, t, criterion='distance')
```

ุชูุฌู ุดูุฏ ฺฉู Z ููุงู ุฎุฑูุฌ ุชุงุจุน `linkage` ุงุณุช ฺฉู ูพุดุชุฑ ุชูุถุญ ุฏุงุฏู ุดุฏ.

ููุฏุงุฑ ุจุงุฒฺฏุดุช ุงู ุชุงุจุน ุจู ุตูุฑุช ุขุฑุงูโุง ุงุฒ ุดูุงุฑู ุฎูุดูโูุงุณุช (ูุชูุงุธุฑ ุจุง ูุฑ ุฏุงุฏู ุฏุฑ ูุฑูุฏ ุงููู)ุ ูุซูุง ุงฺฏุฑ 5 ุฏุงุฏู ุฏุฑ ุฏู ุฎูุดู ุฏุงุดุชู ุจุงุดู:

```
array([1, 1, 2, 2, 2])
```

### ุชุงุจุน clusterdata

ุชุงุจุน `clusterdata` ุฏุฑ ูุงูุน ุฌูุนุจูุฏ ุชูุงู ููุงุฑุฏ ุงุณุช ฺฉู ุชุง ุจู ุงูุงู ฺฏูุชู ุดุฏุ ุนู:

`pdist()` โ `linkage()` โ `fcluster`

ุจู ุงู ุดฺฉู ฺฉู ุงู ุชุงุจุน ุจุตูุฑุช ุฎูุฏฺฉุงุฑุ ุชูุงู ูุฑุงุญู ุฎูุดูโุจูุฏ ุณูุณูู ูุฑุงุชุจ ุฑุง ุงูุฌุงู ูโุฏูุฏุ ูพุณ ุฏฺฏุฑ ูุงุฒ ุจู ูุญุงุณุจู ุฏุณุช ูุงุตููโูุง ู ุง linkage ูุณุช.

```python
from scipy.cluster.hierarchy import clusterdata

clusterdata(X, method='single', metric='euclidean', t=1.0, criterion='inconsistent')
```

ุงู ุชุงุจุน ุฏุงุฏูโูุง ูุฑูุฏ ุฑุง ุฎูุดูโุจูุฏ ูโฺฉูุฏ ู ุฎุฑูุฌโุงุด ุดูุงุฑูโ ุฎูุดูโ ูุฑ ุฏุงุฏู ุงุณุช.

**ูฺฉุชู ููู:** ุชุงุจุน `clusterdata` ุจุฑุง ุฏุงุฏูโูุง ฺฉูฺฺฉ ู ูุงูโุญุฌู ุนุงู ุงุณุชุ ุงูุง ุงฺฏุฑ ุฏุงุฏูโูุง ุฎู ุฒุงุฏ ูุณุชูุฏ ุง ฺฉูุชุฑู ุฏููโุชุฑ ุฑู ูุฑุงุญู ุฎูุดูโุจูุฏ ูุงุฒ ุงุณุชุ ุจูุชุฑ ุงุณุช ุงุฒ `linkage()` ู `fcluster()` ุจูโุตูุฑุช ุฌุฏุงฺฏุงูู ุงุณุชูุงุฏู ุดูุฏ.


## ุญู ฺฉ ูุซุงู
---
ฺฉุฏ ุฒุฑ ุจู ุฌูุช ุชููู ุจุดุชุฑ ููุงูู ู ฺฉ ูุซุงู ฺฉุงูู ุขูุฑุฏู ุดุฏู ุงุณุช.
ุงุจุชุฏุง ฺฉุชุงุจุฎุงููโูุง ู ุชูุงุจุน ููุฑุฏ ูุงุฒ ุฑุง ุจู ุจุฑูุงูู ุงุถุงูู ูฺฉูู:

```python
import numpy as np
from scipy.spatial.distance import pdist, squareform
from scipy.cluster.hierarchy import linkage, dendrogram, inconsistent, fcluster
import matplotlib.pyplot as plt
```

ุญุงู ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน `np.array()`ุ ุฏุชุงูุง ุฎูุฏ ุฑุง ูุงุฑุฏ ุจุฑูุงูู ูโฺฉูู:

```python
X = np.array([
    [2, 3],
    [4, 5],
    [7, 4],
    [2, 4],
    [3, 2],
    [8, 3]
])
print(X)
```

<i>ุฎุฑูุฌ:</i>

```
[[2 3]
 [4 5]
 [7 4]
 [2 4]
 [3 2]
 [8 3]]
```

ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน `pdist()` ู ูุชุฏ ุงููุฏุณุ ูุงุชุฑุณ ุชูุงุถู ุฑุง ุณุงุฎุชู ู ุจู ฺฉูฺฉ ุชุงุจุน `squareform()` ุขู ุฑุง ุจู ุดฺฉู ุงุณุชุงูุฏุงุฑุฏ (ูุฑุจุน) ููุงุด ูโุฏูู:

```python
Y = pdist(X, 'euclidean')
print(squareform(Y))
```

<i>ุฎุฑูุฌ:</i>

```
[[0.         2.82842712 5.09901951 1.         1.41421356 6.        ]
 [2.82842712 0.         3.16227766 2.23606798 3.16227766 4.47213595]
 [5.09901951 3.16227766 0.         5.         4.47213595 1.41421356]
 [1.         2.23606798 5.         0.         2.23606798 6.08276253]
 [1.41421356 3.16227766 4.47213595 2.23606798 0.         5.09901951]
 [6.         4.47213595 1.41421356 6.08276253 5.09901951 0.        ]]
 ```

ููุงูุทูุฑ ฺฉู ุงุฒ ุฏุฑุณูุงูู ุจุฎุงุทุฑ ุฏุงุฑุฏุ ุจุงุฏ ุฏุฑ ุงู ูุงุชุฑุณ ุจู ุฏูุจุงู ฺฉูุชุฑู ููุฏุงุฑ ุจู ุฌูุช ุฎูุดูโุจูุฏ ุจฺฏุฑุฏู ู ุขููุง ุฑุง ุจุง ูู ุงุฏุบุงู ฺฉูู. ูุซูุง ุฏุฑ ุงููู ูุฏูุ ุฏุงุฏู ุงูู ู ฺูุงุฑู ุจุง ฺฉูุชุฑู ููุฏุงุฑ ูุงุตูู (ููุฏุงุฑ 1) ุจุง ฺฉุฏฺฏุฑ ุงุฏุบุงู ูโุดููุฏ.
ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน `linkage()`ุ ุงู ุงุฏุบุงูโูุง ู ููุงุตู ุจู ุฎูุดูโูุง ุฑุง ูุชูุงู ูุดุงูุฏู ฺฉุฑุฏ:

```python
Z = linkage(Y, 'single', 'euclidean')
print(Z)
```

<i>ุฎุฑูุฌ:</i>

```
[[0.         3.         1.         2.        ]
 [4.         6.         1.41421356 3.        ]
 [2.         5.         1.41421356 2.        ]
 [1.         7.         2.23606798 4.        ]
 [8.         9.         3.16227766 6.        ]]
```

ุชูุณุฑ ุฎุฑูุฌ ุชุงุจุน `linkage()` ูพุดุชุฑ ุขูุฑุฏู ุดุฏู ุงุณุช. ุจุทูุฑ ูุซุงู ุฏุฑ ุณุทุฑ ุงูู ุจุงู ุดุฏู ฺฉู ุฏุงุฏู 0 ู 3 ุจุง ฺฉุฏฺฏุฑ ุงุฏุบุงู ู ูุฒุงู ูุงุตูู ุขููุง ุงุฒ ูู 1 ุจูุฏู ุงุณุช. ุนุฏุฏ ุขุฎุฑ ูุดุงู ูุฏูุฏ ฺฉู ุงู ุฎูุดู ุฏุฑ ูุฌููุน 2 ุฏุงุฏู ุฏุงุฑุฏ.
ุจู ุฑุงุญุช ู ุจุง ููุดุชู ุชุงุจุน `dendrogram` ูุชูุงู ูููุฏุงุฑ ุขู ุฑุง ุฑุณู ฺฉุฑุฏ:

```python
dendrogram(Z)
```

<i>ุฎุฑูุฌ:</i>

<img src="/assets/patterneffort/linkage/img-03.png" alt="Dendrogram">

```python
R = inconsistent(Z, d=2)
print(W)
```

```
[[1.         0.         1.         0.        ]
 [1.20710678 0.29289322 2.         0.70710678]
 [1.41421356 0.         1.         0.        ]
 [1.82514077 0.58113883 2.         0.70710678]
 [2.27085307 0.87455104 3.         1.01929396]]
```

ุงูุง ุงฺฏุฑ ุจุฎูุงูู ุงู ุฎุฑูุฌ ุฑุง ุชูุณุฑ ฺฉููุ ููุงูุทูุฑ ฺฉู ูพุดุชุฑ ฺฏูุชู ุดุฏุ ูุงุฒ ุงุณุช ุจุฏุงูู ฺฉุฏุงู ุณุชูู ฺู ููุงุฏุฑ ุฑุง ุจุฑูฺฏุฑุฏุงููุฏ. ุจุทูุฑ ูุซุงูุ ุณุทุฑ ุฏูู ุฑุง ุจุฑุฑุณ ูโฺฉูู:
- ุงููู ุนุฏุฏ ุฏุฑ ุงู ุณุทุฑ ูุชูุงุธุฑ ุจุง ูุงูฺฏู ูุงุตูู ุฏุฑ ุฎูุดู ุงุณุช ฺฉู ููุฏุงุฑ ุขู 1.2 ูโุจุงุดุฏ.
- ุฏููู ููุฏุงุฑ ูุฒ ุงูุญุฑุงู ูุนุงุฑ ุฑุง ุจุง ููุฏุงุฑ 0.29 ูุดุงู ูโุฏูุฏ.
- ููุฏุงุฑ ุณูู ุชุนุฏุงุฏ ุฏุงุฏูโูุง ุฏุฑ ูุฑ ุฎูุดู ุงุณุช (2 ุฏุงุฏู)
- ู ุขุฎุฑู ุฏุงุฏู ูุฑุจูุท ุจู ุถุฑุจ ูุงุณุงุฒฺฏุงุฑุณุช ฺฉู ูพุดุชุฑ ุชูุถุญ ุขู ุฏุงุฏู ุดุฏ (ุจุง ููุฏุงุฑ 0.7)

ูุชูุงู ุฎุฑูุฌ ุงู ุชุงุจุน ุฑุง ุจู ุงุฒุง d=4 ูุฒ ุจุฑุฑุณ ฺฉุฑุฏ:

```
[[1.         0.         1.         0.        ]
 [1.20710678 0.29289322 2.         0.70710678]
 [1.41421356 0.         1.         0.        ]
 [1.55009385 0.62913719 3.         1.0903411 ]
 [1.84535455 0.86216774 5.         1.52745578]]
```

<img src="/assets/patterneffort/linkage/img-04.png" alt="Inconsistancy">


ุฏุฑ ููุงุช ุจุง ุงุณุชูุงุฏู ุงุฒ `fcluster`ุ ูุชูุงูู ุฏุงุฏูโูุง ุฑุง ุฏุฑ ุฏุณุชูโูุง (ุฎูุดูโูุง)ุ ุฏุณุชูโุจูุฏ ฺฉูู:

```python
T = fcluster(Z, 1, depth=2)
print(T)
```

<i>ุฎุฑูุฌ:</i>

```
[2 2 1 2 2 1]
```

ูพุฑ ูุงุถุฎ ุงุณุช ฺฉู ุฏุงุฏูโูุง ุฏุฑ ุฏู ุฏุณุชู ู ุจุง ุจุฑฺุณุจ 1 ู 2 ุฎูุดูโุจูุฏ ุดุฏูโุงูุฏุ ุจู ุงู ุดฺฉู ฺฉู ุฏุงุฏู ุงูู ู ุฏูู ุฏุฑ ุฎูุดู 2 ู ุฏุงุฏู ุณูู ุฏุฑ ุฎูุดู 1 ู ... ูุฑุงุฑ ฺฏุฑูุชูโุงูุฏ.


## ุชููุฏ ฺุฑุฎ ุงุฒ ุงูู!
---
ุงฺฏุฑ ุดูุง ูู ุฌุฒู ฺฉุณุงู ูุณุชุฏ ฺฉู ุฏูุณุช ุฏุงุฑู ฺุฑุฎ ุฑุง ุงุฒ ุงุจุชุฏุง ู ุจู ุฏุณุช ุฎูุฏุดุงู ุชููุฏ ฺฉููุฏุ ฺฉุฏ ุฒุฑ ูพุงุฏู ุณุงุฒ ุฑูุด single-linkage clustring ูุณุช ฺฉู ุฏุฏ ุจุณุงุฑ ุฎูุจ ุจู ุดูุง ุฎูุงูุฏ ุฏุงุฏ ู ุจู ุฑุงุญุช ูุชูุงู ูพุงุฑุงูุชุฑ ูุง ุขู ุฑุง ุฌุงฺฏุฒู ู ุชูุงู ุชุบุฑุงุช ุฑุง ุจุฑุฑุณ ฺฉุฑุฏ. ูุทุนุง ุจุฑุง ุงูุฌุงู ูุญุงุณุจุงุช ุฏู ุฏุณุช ู ุณุฑุนุ ุงุณุชูุงุฏู ุงุฒ ฺฉุชุงุจุฎุงูู scipy ุจุณุงุฑ ุฑุงุญุช ุชุฑ ู ุณุฑุนุชุฑ ุฎูุงูุฏ ุจูุฏุ ุงูุง ุงฺฏุฑ ูุตุฏ ุชุบุฑุงุช ู ุง ุงุถุงูู ฺฉุฑุฏู ููุงุฑุฏ ุจู ุงู ุงูฺฏูุฑุชู ุฑุง ุฏุงุฑุฏุ ูุงุฒ ุงุณุช ฺฉู ุฎูุฏุชุงู ุฏุณุช ุจฺฉุงุฑ ุดุฏู ู ุชูุงู ูุฑุงุญู ุฑุง ุงุฒ ุงุจุชุฏุง ู ุจุง ุงุฏู ูุง ุฎูุฏุชุงู ูพุงุฏู ุณุงุฒ ฺฉูุฏ. ูุทุนุง ุจู ูุฏู ูุง ูุชูุงูุช ูุชูุงู ุงู ุงูฺฏูุฑุชู ุฑุง ูพุงุฏู ุณุงุฒ ู ูุตูุฑุณุงุฒ ฺฉุฑุฏ ฺฉู ุฏุฑ ุงุฏุงููุ ุจู ุขูุฑุฏู ฺฉ ููููู ุงุฒ ุขู ุงฺฉุชูุง ูฺฉูู:


```python
import numpy as np
from scipy.spatial.distance import pdist, squareform
import matplotlib.pyplot as plt

class SingleLinkageClustering:
    def __init__(self):
        self.labels_ = None
        self.distances_ = None
        
    def fit(self, X, n_clusters=2):
        """
        Single Linkage Clustering
        
        Parameters:
        X : array-like, shape (n_samples, n_features)
            Input data
        n_clusters : int, default=2
            Number of clusters to form
        """
        n_samples = X.shape[0]
        
        # ูุญุงุณุจู ูุงุชุฑุณ ูุงุตูู
        self.distances_ = squareform(pdist(X))
        
        # ููุฏุงุฑุฏู ุงููู: ูุฑ ููุทู ฺฉ ุฎูุดู ุงุณุช
        clusters = [[i] for i in range(n_samples)]
        
        # ุงูฺฏูุฑุชู ุณูุณูู ูุฑุงุชุจ
        while len(clusters) > n_clusters:
            # ูพุฏุง ฺฉุฑุฏู ูุฒุฏฺฉโุชุฑู ุฏู ุฎูุดู
            min_distance = float('inf')
            merge_i, merge_j = -1, -1
            
            for i in range(len(clusters)):
                for j in range(i + 1, len(clusters)):
                    # ูุญุงุณุจู ูุงุตูู single linkage (ุญุฏุงูู ูุงุตูู ุจู ููุงุท ุฏู ุฎูุดู)
                    distance = self._single_linkage_distance(clusters[i], clusters[j])
                    if distance < min_distance:
                        min_distance = distance
                        merge_i, merge_j = i, j
            
            # ุงุฏุบุงู ุฏู ุฎูุดู
            clusters[merge_i].extend(clusters[merge_j])
            clusters.pop(merge_j)
        
        # ุงุฌุงุฏ ุจุฑฺุณุจโูุง ุฎูุดู
        self.labels_ = np.zeros(n_samples, dtype=int)
        for cluster_idx, cluster in enumerate(clusters):
            for point_idx in cluster:
                self.labels_[point_idx] = cluster_idx
                
        return self
    
    def _single_linkage_distance(self, cluster1, cluster2):
        """ูุญุงุณุจู ูุงุตูู single linkage ุจู ุฏู ุฎูุดู"""
        min_distance = float('inf')
        for i in cluster1:
            for j in cluster2:
                distance = self.distances_[i, j]
                if distance < min_distance:
                    min_distance = distance
        return min_distance

# ูุซุงู ุงุณุชูุงุฏู
if __name__ == "__main__":
    # ุชููุฏ ุฏุงุฏูโูุง ููููู
    np.random.seed(42)
    
    # ุณู ุฎูุดู ูุฌุฒุง
    cluster1 = np.random.normal(2, 0.5, (10, 2))
    cluster2 = np.random.normal(8, 0.5, (10, 2))
    cluster3 = np.random.normal(5, 0.5, (10, 2))
    
    X = np.vstack([cluster1, cluster2, cluster3])
    
    # ุงุฌุฑุง ุงูฺฏูุฑุชู
    slc = SingleLinkageClustering()
    slc.fit(X, n_clusters=3)
    
    # ููุงุด ูุชุงุฌ
    plt.figure(figsize=(12, 5))
    
    plt.subplot(1, 2, 1)
    plt.scatter(X[:, 0], X[:, 1], c='blue', alpha=0.7)
    plt.title('Orginal Data')
    
    plt.subplot(1, 2, 2)
    colors = ['red', 'green', 'blue', 'orange', 'purple']
    for i in range(3):
        cluster_points = X[slc.labels_ == i]
        plt.scatter(cluster_points[:, 0], cluster_points[:, 1], 
                   c=colors[i], label=f'Cluster {i+1}', alpha=0.7)
    plt.title('Single Linkage Clustering')
    plt.legend()
    
    plt.tight_layout()
    plt.show()
```


ุฏุฑ ุงูุชูุงุ ููููู ุชุตูุฑ ุงุฒ ุฎุฑูุฌ ฺฉุฏ ุจุงูุง ุขูุฑุฏู ุดุฏู ุงุณุช:

<img src="/assets/patterneffort/single_linkage_clustring/img-05.png" alt="Single Linkage">


### ููุงุจุน
---
1. <a href="https://www.geeksforgeeks.org/machine-learning/agglomerative-methods-in-machine-learning/" target ="_blank">https://www.geeksforgeeks.org/machine-learning/agglomerative-methods-in-machine-learning/</a>
2. <a href="https://www.geeksforgeeks.org/machine-learning/ml-types-of-linkages-in-clustering/" target ="_blank">https://www.geeksforgeeks.org/machine-learning/ml-types-of-linkages-in-clustering/</a>
3. <a href="https://en.wikipedia.org/wiki/Single-linkage_clustering" target ="_blank">https://en.wikipedia.org/wiki/Single-linkage_clustering</a>
4. <a href="https://harikabonthu96.medium.com/single-link-clustering-clearly-explained-90dff58db5cb" target ="_blank">https://harikabonthu96.medium.com/single-link-clustering-clearly-explained-90dff58db5cb</a>