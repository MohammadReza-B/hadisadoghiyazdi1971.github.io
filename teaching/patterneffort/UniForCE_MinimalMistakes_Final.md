---
layout: persian
title: "UniForCE"
permalink: /teaching/studenteffort/patterneffort/UniForCE_MinimalMistakes_Final/
dir: rtl
classes: wide rtl-layout
author_profile: true
description: "ฺฏุฒุงุฑุด ฺฉุงูู ูพุงุฏูโุณุงุฒ UniForCEู ููุงุณู ุจุง KMeans."
use_math: true
mathjax: true

header:
  overlay_image: "/assets/images/background.jpg"
  overlay_filter: 0.3
  overlay_color: "#5e616c"
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"
---

<div class="english-text">
<strong>
  UniForCE
</strong>
</div>

## ููุณูุฏู

<strong>ููุฏู ุณุงุฏุงุช ูุงุณู</strong>

## ุฑุงูโูุง ุงุฑุชุจุงุท

<p align="center">
  <a href="https://github.com/mahdiehgh79">
    <img src="https://img.shields.io/badge/GitHub-YourUsername-181717?logo=github&logoColor=white&style=flat-square" />
  </a>
</p>

**[ุขุฏุฑุณ ุงูู:]** mahdiehghasemi79@gmail.com

<a href="https://www.um.ac.ir/" style="text-decoration:underline; color:green;" target="_blank">
<strong>ุฏุงูุดฺฏุงู ูุฑุฏูุณ ูุดูุฏ</strong>
</a>

**(Unimodal Forest for Clustering and Estimation of k)**

## ููุฑุณุช ูุทุงูุจ

1. [ููุฏูู](#ููุฏูู)
2. [ุชุนุงุฑู ู ูุจุงู ุฑุงุถ](#ุชุนุงุฑู-ู-ูุจุงู-ุฑุงุถ)
3. [ุดุฑุญ ุงูฺฏูุฑุชู (ุดุจูโฺฉุฏ)](#ุดุฑุญ-ุงูฺฏูุฑุชู-ุดุจูโฺฉุฏ)
4. [ูุฑุงุญู ุฎูุดูโุจูุฏ](#ูุฑุงุญู-ุฎูุดูุจูุฏ)
5. [ุชุญูู ุนููฺฉุฑุฏ ูุฑุญููโุจูโูุฑุญูู ุฏุฑ ฺฉุฏ](#ุชุญูู-ุนููฺฉุฑุฏ-ูุฑุญูุจููุฑุญูู-ุฏุฑ-ฺฉุฏ)
6. [ุขุฒูุงุดโูุงุ ูุชุงุฌ ู ููุงุณู ุจุง KMeans](#ุขุฒูุงุดูุง-ูุชุงุฌ-ู-ููุงุณู-ุจุง-kmeans)
7. [ุชุญูู ฺฏุฑุงูฺฉ ูุชุงุฌ](#ุชุญูู-ฺฏุฑุงูฺฉ-ูุชุงุฌ-ุฎูุดูุจูุฏ)
8. [ุฌูุนโุจูุฏ](#ุฌูุนุจูุฏ)
9. [ูุชุฌูโฺฏุฑ ููุง](#ูุชุฌูฺฏุฑ-ููุง)
10. [ููุงุจุน](#ููุงุจุน)

---

## ููุฏูู

ุงูฺฏูุฑุชู **UniForCE** (Unimodal Forest for Clustering and Estimation of \(k\)) ฺฉ ุฑูุด ูุจุชู ุจุฑ ุดฺฉู ฺฺฏุงู ุงุณุช ฺฉู ูุฏู ุขู ููโุฒูุงู ุฎูุดูโุจูุฏ ู ุชุฎูู ุฎูุฏฺฉุงุฑ ุชุนุฏุงุฏ ุฎูุดูโูุง ุงุณุช.

---

## ุชุนุงุฑู ู ูุจุงู ุฑุงุถ

### ุฎูุดูู ุชฺฉโูุฌู (Unimodal Cluster)

ุฏุฑ ูุณุฆููู ุฎูุดูโุจูุฏุ ฺฉ **ุฎูุดูู ุชฺฉโูุฌู** ุจู ูุฌููุนูโุง ุงุฒ ููุงุท ุฏุฑ ูุถุง ูฺฺฏ ฺฏูุชู ูโุดูุฏ ฺฉู ฺฺฏุงู ุฏุงุฏูโูุง ุฏุฑ ุขู ููุท **ฺฉ ููู ุง ุจุดูู** ุฏุงุฑุฏ.

ุจูโุตูุฑุช ุฑุณูุ ุงฺฏุฑ $\(C\)$ ุฒุฑูุฌููุนูโุง ุงุฒ ุฏุงุฏูโูุง ุจุงุดุฏ ู \(f_C(x)\) ฺฺฏุงู ุชุฎูู ููุงุท ุฏุฑ ุขู ูุงุญู ุฑุง ูุดุงู ุฏูุฏุ ุขูฺฏุงู ุฎูุดูู \(C\) ุฑุง **ุชฺฉโูุฌู** ูโูุงููุ ุงฺฏุฑ ุชุงุจุน ฺฺฏุงู \(f_C(x)\) ููุท ฺฉ ููุทูู ุจุดูู ุฏุงุดุชู ุจุงุดุฏ.

---

### ุขุฒููู ุชฺฉโูุฌู ุจูุฏู ุฏู ุฎูุดู (Unimodality Test)

ุจุฑุง ุฏู ุฎูุดูู $$A$$ ู $$B$$ุ ุชุฑฺฉุจ ุขูโูุง ุฑุง ุจุฑุฑุณ ูโฺฉูู ุชุง ูุดุฎุต ุดูุฏ ุขุง ฺฺฏุงู ุฏุงุฏูโูุง ุญุงุตู ุงุฒ ุชุฑฺฉุจุดุงู ูููุฒ **ุชฺฉโูุฌู** ุงุณุช ุง ูู.

$$
\text{Unimodal}(A,B) =
\begin{cases}
\text{True}, & \text{if } f_{A \cup B} \text{ has exactly one peak}, \\[4pt]
\text{False}, & \text{otherwise}.
\end{cases}
$$

ุงฺฏุฑ ุชุฑฺฉุจ ุฏู ุฎูุดู ููุท ฺฉ ููู ุฏุงุดุชู ุจุงุดุฏุ ุขูฺฏุงู ูุชุฌู ูโฺฏุฑู ฺฉู ุชุฑฺฉุจ ุขูโูุง **ุชฺฉโูุฌู** ุงุณุช ู ูโุชูุงู ุฏู ุฎูุดู ุฑุง **ุงุฏุบุงู ฺฉุฑุฏ**.  
ุงูุง ุงฺฏุฑ ุชุฑฺฉุจ ุขูโูุง ุจุด ุงุฒ ฺฉ ููู ุฏุงุดุชู ุจุงุดุฏุ ฺฺฏุงู **ฺูุฏูุฌู** ุงุณุช ู ุฎูุดูโูุง ุจุงุฏ **ุฌุฏุง ุจูุงููุฏ**.

---

### ฺฺฏุงู ุชุฎูู ู ุขุฒููู Dip

ุจุฑุง ุชุนู ุชุนุฏุงุฏ ูููโูุงุ ุงุฒ ุฑูุด **ุชุฎูู ฺฺฏุงู ูุณุชูโุง (KDE)** ุจุฑุง ุจุฑุขูุฑุฏ ุชุงุจุน ฺฺฏุงู ุชุฑฺฉุจ ุงุณุชูุงุฏู ูโุดูุฏ.  
ุฑูุด KDE ฺฉ ุงุฒ ุชฺฉูฺฉโูุง ูพุฑฺฉุงุฑุจุฑุฏ ุฏุฑ ุขูุงุฑ ุจุฑุง ุชุฎูู ฺฺฏุงู ุชูุฒุน ุฏุงุฏูโูุงุณุช ู ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุนโูุง ูุณุชูโุง (Kernel)  
ฺฉ ุชุฎูู ูุฑู ุงุฒ ุชูุฒุน ุงุญุชูุงูุงุช ุฏุงุฏูโูุง ุงุฑุงุฆู ูโุฏูุฏ.

๐ [ูุนุฑู ุฑูุด KDE](https://en.wikipedia.org/wiki/Kernel_density_estimation)

ุณูพุณ ุงุฒ **ุขุฒููู Dip** ุจุฑุง ุจุฑุฑุณ ฺฉุชุง ูููโูุง ุงุณุชูุงุฏู ูโฺฉูู.

ุฏุฑ ุงู ุขุฒูููุ ููุฏุงุฑ ุงุญุชูุงู ุง ููุงู **p-value** ูุญุงุณุจู ูโุดูุฏ.  
ุชูุณุฑ ูุชุฌู ุจูโุตูุฑุช ุฒุฑ ุงุณุช:

- ุงฺฏุฑ ููุฏุงุฑ p ุจุฑุงุจุฑ ุง ุจุฒุฑฺฏโุชุฑ ุงุฒ ุณุทุญ ูุนูโุฏุงุฑ ฮฑ ุจุงุดุฏ (ูุซูุงู ฐูซฐต)ุ ุฏุงุฏูโูุง **ุชฺฉโูุฌู** ูุณุชูุฏ ู ูุฑุถูู ุตูุฑ ูพุฐุฑูุชู ูโุดูุฏ.
- ุงฺฏุฑ ููุฏุงุฑ p ฺฉูฺฺฉโุชุฑ ุงุฒ ฮฑ ุจุงุดุฏุ ุฏุงุฏูโูุง **ฺูุฏูุฌู** ูุณุชูุฏ ู ูุฑุถูู ุตูุฑ ุฑุฏ ูโุดูุฏ.

ุจู ุจุงู ุณุงุฏูโุชุฑ:

- ููุฏุงุฑ ุจุฒุฑฺฏ p โ ฺฺฏุงู ููุท ฺฉ ููู ุฏุงุฑุฏ (**ุชฺฉโูุฌู**).
- ููุฏุงุฑ ฺฉูฺฺฉ p โ ฺฺฏุงู ฺูุฏ ููู ุฏุงุฑุฏ (**ฺูุฏูุฌู**).

ุจุฑุง ูุทุงูุนู ู ุชูุถุญุงุช ุจุดุชุฑ ุฏุฑุจุงุฑูู ุชูุณุฑ ุขุฒููู **Dip Test**ุ  
ูโุชูุงูุฏ ุจู ููฺฉ ุฒุฑ ูุฑุงุฌุนู ฺฉูุฏ:

๐ [ุชูุถุญุงุช ุจุดุชุฑ ุฏุฑ ุณุงุช StackExchange](https://stats.stackexchange.com/questions/156808/interpretation-of-hartigans-dip-test)

### ุฎูุดูโุจูุฏ ุงููู (Overclustering)

ุฏุฑ ูุฑุญููู ูุฎุณุช ุงูฺฏูุฑุชูุ ุฏุงุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ **K-Means** ุจุง ุชุนุฏุงุฏ ุฒุงุฏ ุฎูุดูโูุง (\(k_0\)) ุชูุณู ูโุดููุฏ ุชุง ุณุงุฎุชุงุฑูุง ูุญู ุจูโุฎูุจ ูุดุฎุต ุดููุฏ.  
ุณูพุณ ุฏุฑ ูุฑุงุญู ุจุนุฏุ ุฎูุดูโูุง ูุฒุฏฺฉ ุจุง ุขุฒููู ุชฺฉโูุฌู ุงุฏุบุงู ูโุดููุฏ ุชุง ุฎูุดูโูุง ููุง ุดฺฉู ฺฏุฑูุฏ.

---

### ** ุจุฑุขูุฑุฏ ุชุนุฏุงุฏ ุฎูุดูโูุง (k)**

ุชุนุฏุงุฏ ููุง ุฎูุดูโูุง ุจุฑุงุจุฑ ุงุณุช ุจุง ุชุนุฏุงุฏ ูุคูููโูุง ููุจูุฏ ุฏุฑ ฺฏุฑุงู ููุง **ุฌูฺฏู ุชฺฉโูุฌู (Unimodality Forest)**:

## ุดุฑุญ ุงูฺฏูุฑุชู (ุดุจูโฺฉุฏ)

```text
INPUT: ุฏุงุฏูโูุง Xุ (ุงุฎุชุงุฑ) k_true
1. Overclustering: ุงุฌุฑุง KMeans ุจุง k0 (k0 >> ุงูุชุธุงุฑ ุจุฑุง k) -> ุจุฎุดโูุง ูุญู
2. ุจุฑุง ูุฑ ุฒูุฌ ุฎูุดู (A,B):
   a. ูพุฑูุฌฺฉุช ููุงุท AโชB ุฑู ูฺฉุชูุฑ c_B - c_A
   b. ุจุฑุขูุฑุฏ ฺฺฏุงู 1D (KDE) ู/ุง ุงูุฌุงู Dip test ุจุฑ ุฑู ุชูุฒุน ูพุฑูฺูโุดุฏู
   c. ุงฺฏุฑ ุชูุฒุน ุชฺฉโูุฌู ุจุงุดุฏ -> ุนูุงูุช Merge(A,B)
3. ุงุนูุงู ุงูุญุงูุงุช (greedy ุง ุจุง ุงูฺฏูุฑุชู ุดุจู Kruskal ุจุง ุดุฑุท unimodal)
4. ุชฺฉุฑุงุฑ ูุฑุงุญู 2โ3 ุชุง ููฺฏุฑุง
OUTPUT: ุจุฑฺุณุจโูุง ููุงุ ููุฑุณุช ุฎูุดูโูุงุ ู ุจุฑุขูุฑุฏ k
```

---

### ุงุณุชุฎุฑุงุฌู ฺฉูุฏ ุงุฒ ฺฉุฏ

```python
import numpy as np
from scipy.stats import gaussian_kde
from sklearn.cluster import KMeans
from sklearn.metrics import adjusted_rand_score
import matplotlib.pyplot as plt
import pandas as pd
import os

def count_peaks_1d(data_1d, bw_method='scott', grid_points=512):
    data_1d = np.asarray(data_1d)
    if data_1d.size < 5:
        return 1
    kde = gaussian_kde(data_1d, bw_method=bw_method)
    xs = np.linspace(data_1d.min(), data_1d.max(), grid_points)
    ys = kde(xs)
    peaks = 0
    for i in range(1, len(ys)-1):
        if ys[i] > ys[i-1] and ys[i] > ys[i+1]:
            peaks += 1
    return max(1, peaks)

class UniForCE:
    def __init__(self, alpha=0.001, M=25, L=11, k_prime_factor=3):
        self.alpha = alpha
        self.M = M
        self.L = L
        self.k_prime_factor = k_prime_factor

    def overclustering(self, X, k_true=None):
        n = X.shape[0]
        if k_true is None:
            k_prime = min(max(10, n // 10), 50)
        else:
            k_prime = max(10, k_true * self.k_prime_factor)
        km = KMeans(n_clusters=k_prime, random_state=0).fit(X)
        labels = km.labels_
        clusters = []
        for i in range(k_prime):
            pts = X[labels == i]
            if len(pts) >= self.M:
                clusters.append(pts)
        return clusters

    def calculate_signed_distances(self, cluster_i, cluster_j):
        mu_i = cluster_i.mean(axis=0)
        mu_j = cluster_j.mean(axis=0)
        r_ij = mu_j - mu_i
        norm = np.linalg.norm(r_ij)
        if norm < 1e-8:
            return np.zeros(len(np.vstack([cluster_i, cluster_j])))
        midpoint = 0.5 * (mu_i + mu_j)
        combined = np.vstack([cluster_i, cluster_j])
        distances = []
        for p in combined:
            numerator = np.dot(r_ij, p) - np.dot(r_ij, midpoint)
            distances.append(numerator / norm)
        return np.array(distances)

    def unimodal_test(self, cluster_i, cluster_j):
        votes = 0
        n_i, n_j = len(cluster_i), len(cluster_j)
        sample_size = min(n_i, n_j)
        for _ in range(self.L):
            if n_i <= n_j:
                sample_i = cluster_i
                idx = np.random.choice(n_j, sample_size, replace=False)
                sample_j = cluster_j[idx]
            else:
                idx = np.random.choice(n_i, sample_size, replace=False)
                sample_i = cluster_i[idx]
                sample_j = cluster_j
            distances = self.calculate_signed_distances(sample_i, sample_j)
            peaks = count_peaks_1d(distances)
            # Here we use a peaks-based heuristic instead of a dip test for robustness
            if peaks == 1:
                votes += 1
        return votes > (self.L // 2)

    def build_unimodality_forest(self, clusters):
        import networkx as nx
        G = nx.Graph()
        n = len(clusters)
        centers = [c.mean(axis=0) for c in clusters]
        G.add_nodes_from(range(n))
        edges = []
        for i in range(n):
            for j in range(i+1, n):
                dist = np.linalg.norm(centers[i] - centers[j])
                edges.append((i, j, dist))
        edges.sort(key=lambda x: x[2])
        for i, j, d in edges:
            if not nx.has_path(G, i, j):
                if self.unimodal_test(clusters[i], clusters[j]):
                    G.add_edge(i, j, weight=d)
        return G

    def fit(self, X, k_true=None):
        clusters = self.overclustering(X, k_true)
        forest = self.build_unimodality_forest(clusters)
        # extract connected components as final clusters
        import networkx as nx
        labels = -1 * np.ones(len(X), dtype=int)
        final_clusters = []
        for comp_id, comp in enumerate(nx.connected_components(forest)):
            # collect points from constituent overclusters
            pts = np.vstack([clusters[idx] for idx in comp])
            final_clusters.append(pts)
            # Note: mapping back to original indices requires careful bookkeeping;
            # here we assume overclustering preserved original ordering (or use indices)
        k_est = len(final_clusters)
        return {'labels': labels, 'clusters': final_clusters, 'k_estimated': k_est, 'forest': forest}
```

---

## ูุฑุงุญู ุฎูุดูโุจูุฏ

### ฑ) ุฎูุดูโุจูุฏ ุงููู (Overclustering)

- **ูุฏู:** ุชูุณู ูุถุง ุฏุงุฏู ุจู ุจุฎุดโูุง ฺฉูฺฺฉโุชุฑ ุชุง ูุฑุฒูุง ฺฺฏุงู ูุญู ุจูุชุฑ ูุดุฎุต ุดููุฏ.
- **ุฑูุด ุงุฌุฑุง:** ุงุฒ ุงูฺฏูุฑุชู K-Means ุจุง ุชุนุฏุงุฏ ุฎูุดูโูุง ุงููู ุฒุงุฏ ุงุณุชูุงุฏู ูโุดูุฏ.  
  ุชุนุฏุงุฏ ุงูููโ ุฎูุดูโูุง ุจุฑุงุจุฑ ุงุณุช ุจุง ฺฉูููโ ููุฏุงุฑ ุจุฒุฑฺฏโุชุฑ ุจู ุนุฏุฏ ฑฐ ู ฺฉโุฏูู ุชุนุฏุงุฏ ุฏุงุฏูโูุงุ ูู ุญุฏุงฺฉุซุฑ ตฐ ุฎูุดู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ.  
  (ุจูโุตูุฑุช ุชูุฑุจ: ฑฐ โค ุชุนุฏุงุฏ ุฎูุดูโูุง โค ตฐ)
- **ูฺฉุชู:** ุฎูุดูโูุง ฺฉู ุงูุฏุงุฒูู ุขูโูุง ฺฉูุชุฑ ุงุฒ ฺฉ ููุฏุงุฑ ุขุณุชุงููู ูุดุฎุต ุจุงุดูุฏุ ุญุฐู ูโุดููุฏ.

<img src="/assets/patterneffort/uniforcenew/over.png" alt="over_comparison" style="width: 50%; height: 50%; object-fit: contain;">

---

### ฒ) ูุญุงุณุจูู ูุงุตููโูุง ุงูุถุงุดุฏู ู ุงูุฌุงู ุชุตูุฑุณุงุฒ (Projection)

- ุจุฑุง ูุฑ ุฏู ุฎูุดูู i ู jุ ุจุฑุฏุงุฑ ุฌูุช ุจู ูุฑุงฺฉุฒ ุขูโูุง ูุญุงุณุจู ูโุดูุฏ.  
  ุงู ุจุฑุฏุงุฑ ุจุฑุงุจุฑ ุงุณุช ุจุง ุชูุงุถู ูุฑฺฉุฒ ุฎูุดูู j ุงุฒ ูุฑฺฉุฒ ุฎูุดูู i.
- ุณูพุณ ุชูุงู ููุงุท ุงู ุฏู ุฎูุดู ุฑู ุงู ุจุฑุฏุงุฑ ุชุตูุฑ (ูพุฑูุฌฺฉุช) ูโุดููุฏ.  
  ุฏุฑ ุงู ูุฑุญูู ุจุฑุง ูุฑ ููุทู ยซูุงุตููู ุงูุถุงุดุฏูยป ุงุฒ ูุฑฺฉุฒ ุฎูุดู ูุญุงุณุจู ูโฺฏุฑุฏุฏ.
- ุงู ุชุตูุฑุณุงุฒ ุจุงุนุซ ูโุดูุฏ ูุถุง ุฏุงุฏู ุงุฒ ฺูุฏ ุจุนุฏ ุจู ฺฉ ุจุนุฏ ฺฉุงูุด ุงุจุฏ ู ุจุฑุฑุณ ูููโูุง (ูุฏูุง) ุฏุฑ ฺฺฏุงู ุจุณุงุฑ ุณุงุฏูโุชุฑ ุงูุฌุงู ุดูุฏ.

<img src="/assets/patterneffort/uniforcenew/test.png" alt="test_comparison" style="width: 50%; height: 50%; object-fit: contain;">

---

### ณ) ุขุฒููู ุชฺฉโูุฌู ุจูุฏู (Unimodal Test)

- ุฏุฑ ูพุงุฏูโุณุงุฒ ุนูู ุงู ุฑูุดุ ุจูโุฌุง ุงุณุชูุงุฏู ุงุฒ ุขุฒููู **ุฏูพ (Dip Test)** ุจูโุตูุฑุช ูุณุชูู  
  (ฺฉู ููฺฉู ุงุณุช ุจู ุจุณุชูโูุง ุฎุงุฑุฌ ูุงุฒ ุฏุงุดุชู ุจุงุดุฏ)ุ  
  ุงุฒ ฺฉ ุฑูุด ุฌุงฺฏุฒู ู ููุงููโุชุฑ ุจุฑ ูพุงูู **ุชุฎูู ฺฺฏุงู ูุณุชูโุง (KDE)** ู **ุดูุงุฑุด ุชุนุฏุงุฏ ูููโูุง** ุงุณุชูุงุฏู ูโุดูุฏ.
- ุจุฑุง ุงูุฒุงุด ูพุงุฏุงุฑ ุชุตููุ ุงู ุขุฒููู ฺูุฏู ุจุงุฑ ุจุฑ ุฑู ูููููโูุง ุชุตุงุฏู ุงุฒ ุฏุงุฏูโูุง ุงูุฌุงู ูโุดูุฏ  
  (ูุซูุงู ุฏุฑ L ุชฺฉุฑุงุฑ ูุฎุชูู) ู ูุชุฌูู ููุง ุจุฑ ุงุณุงุณ ุฑุฃ ุงฺฉุซุฑุช ุชฺฉุฑุงุฑูุง ุชุนู ูโฺฏุฑุฏุฏ.

---

### ด) ุณุงุฎุช ุฌูฺฏู ุชฺฉโูุฌู (Unimodality Forest)

- ุฏุฑ ุงู ูุฑุญููุ ุชูุงู ุฒูุฌ ุฎูุดูโูุง ุจุฑ ุงุณุงุณ ูุงุตููู ูุงู ูุฑุงฺฉุฒุดุงู ูุฑุชุจ ูโุดููุฏุ
  ุฑููุฏ ูุดุงุจู ุจุง ุงูฺฏูุฑุชู **ฺฉุฑูุณฺฉุงู (Kruskal)** ุจุฑุง ุณุงุฎุช ฺฏุฑุงู ุฏูุจุงู ูโุดูุฏ.
- ูุฑ ุฒูุงู ฺฉู ุชุฑฺฉุจ ุฏู ุฎูุดู ุฏุฑ ุขุฒููู ุชฺฉโูุฌู ูุงุจู ุงุฏุบุงู ุชุดุฎุต ุฏุงุฏู ุดูุฏ  
  ู ุงุชุตุงู ุฌุฏุฏ ุฏุฑ ฺฏุฑุงู ุงุฌุงุฏ ูฺฉูุฏุ ฺฉ ุงู ุจู ุขู ุฏู ุฎูุดู ุงุถุงูู ูโุดูุฏ.
- ุฏุฑ ูพุงุงูุ ูุคูููโูุง ููุจูุฏ ุญุงุตู ุงุฒ ุงู ฺฏุฑุงูุ ููุงู **ุฎูุดูโูุง ููุง ุฏุงุฏูโูุง** ุฑุง ุชุดฺฉู ูโุฏููุฏ.

<img src="/assets/patterneffort/uniforcenew/cluster.png" alt="cluster_comparison" style="width: 50%; height: 50%; object-fit: contain;">

---

## ุชุญูู ุนููฺฉุฑุฏ ูุฑุญููโุจูโูุฑุญูู ุฏุฑ ฺฉุฏ

1. **Overclustering (ุฎูุดูโุจูุฏ ุงููู):**  
   ุฏุฑ ุงุจุชุฏุง ุงุฌุฑุง ุชุงุจุน `fit()`ุ ุฏุงุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ KMeans ู ุชุนุฏุงุฏ ุฒุงุฏ ุฎูุดูโูุง ุงููู ุชูุณู ูโุดููุฏ.  
   ุงู ูุฑุญูู ุฏุฑ ูุชุฏ `overclustering()` ุงูุฌุงู ูโุดูุฏ ู ูุฏู ุขู ุดูุงุณุง ุฒุฑโุฎูุดูโูุง ูุญู ุจุฑุง ุขูุงุฏฺฏ ุฏุฑ ุงุฏุบุงู ุงุณุช.

2. **ูุญุงุณุจูู ูุงุตููโูุง ุงูุถุงโุดุฏู (Signed Distances):**  
   ุจุฑุง ูุฑ ุฌูุช ุฎูุดูุ ูุงูฺฏูโูุง (`ฮผ_i` ู `ฮผ_j`) ฺฏุฑูุชู ูโุดููุฏ ู ุฏุงุฏูโูุง ุฑู ุฎุท ุจู ุงู ุฏู ูุงูฺฏู ูพุฑูุฌฺฉุช ูโุดููุฏ.  
   ุงู ูุฑุญูู ุฏุฑ `calculate_signed_distances()` ุงูุฌุงู ูโฺฏุฑุฏ.

3. **ุขุฒููู ุชฺฉโูุฌู (Unimodal Test):**  
   ุชุงุจุน `unimodal_test()` ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุชุฑฺฉุจ ุฏู ุฎูุดู ุฏุงุฑุง ฺฉ ููู ุฏุฑ ุชูุฒุน ฺฺฏุงู ุงุณุช ุง ุฎุฑ.  
   ุงฺฏุฑ ุชูุฒุน ุชฺฉโูููโุง ุจุงุดุฏุ ุฏู ุฎูุดู ุจูโุนููุงู ูุดุงุจู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดููุฏ.

4. **ุณุงุฎุช ุฌูฺฏู ุชฺฉโูุฌู (Unimodality Forest):**  
   ูุชุฏ `build_unimodality_forest()` ุจุง ุงููุงู ุงุฒ ุงูฺฏูุฑุชู Kruskal ฺฉ ฺฏุฑุงู ุงุฒ ุฑูุงุจุท ุจู ุฎูุดูโูุง ูโุณุงุฒุฏ.  
   ุงูโูุง ฺฉู ุงุฒ ุขุฒููู ุชฺฉโูุฌู ุนุจูุฑ ฺฉุฑุฏูโุงูุฏุ ุฎูุดูโูุง ูุงุจูโุงุฏุบุงู ุฑุง ุจู ูู ูุตู ูโฺฉููุฏ.

5. **ุงุฏุบุงู ุฎูุดูโูุง ู ุชุฎูู ููุง k:**  
   ุฏุฑ ุงูุชูุง ุชุงุจุน `fit()`ุ ูุคูููโูุง ูุชุตู ฺฏุฑุงู ุงุณุชุฎุฑุงุฌ ุดุฏู ู ูุฑฺฉุฏุงู ุจูโุนููุงู ฺฉ ุฎูุดูู ููุง ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดููุฏ.  
   ุชุนุฏุงุฏ ุฎูุดูโูุง (`k_estimated`) ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุฒ ุณุงุฎุชุงุฑ ฺฏุฑุงู ุจูโุฏุณุช ูโุขุฏ.

---

## ุขุฒูุงุดโูุงุ ูุชุงุฌ ู ููุงุณู ุจุง KMeans

<img src="/assets/patterneffort/uniforcenew/blobs_3_comparison.png" alt="blobs_3_comparison" style="width: 50%; height: 50%; object-fit: contain;">

<img src="/assets/patterneffort/uniforcenew/blobs_5_comparison.png" alt="blobs_5_comparison" style="width: 50%; height: 50%; object-fit: contain;">

<img src="/assets/patterneffort/uniforcenew/iris_comparison.png" alt="iris_comparison" style="width: 50%; height: 50%; object-fit: contain;">

<img src="/assets/patterneffort/uniforcenew/moons_comparison.png" alt="moons_comparison" style="width: 50%; height: 50%; object-fit: contain;">

### ูุฌููุนูโุฏุงุฏูโูุง ูพุดููุงุฏ ุจุฑุง ุขุฒูุงุด

- Blobs (k=3) โ ุฎูุดูโูุง ฺฏุงูุณ ุฌุฏุง
- Moons (k=2) โ ุณุงุฎุชุงุฑ ููุงู
- Circles (k=2) โ ุญูููโุง
- Irregular (k=4) โ ุฎูุดูโูุง ูุงููุธู ุจุง ูุงุฑุงูุณ ูุชูุงูุช

### ูุนุงุฑูุง ุงุฑุฒุงุจ ูพุดููุงุฏ

Adjusted Rand Index (ARI)
Normalized Mutual Information (NMI)
Silhouette Score

---

## ุฌุฏูู ุฎูุงุตูู ูุชุงุฌ ุงุฌุฑุง ุงูฺฏูุฑุชูโูุง

| Dataset | n_samples | true_k | uf_k | uf_ARI | km_ARI |
| ------- | --------- | ------ | ---- | ------ | ------ |
| blobs_3 | 300       | 3      | 5    | 0.8754 | 0.9703 |
| blobs_5 | 500       | 5      | 6    | 0.8918 | 0.9516 |
| moons   | 300       | 2      | 10   | 0.2216 | 0.2475 |
| iris    | 150       | 3      | 2    | 0.5584 | 0.7163 |

ุดุงุฎุต **ARI (Adjusted Rand Index)** ูุดุงูโุฏููุฏูู ุดุจุงูุช ุจู ุฎูุดูโุจูุฏ ูพุดโุจูโุดุฏู ู ุจุฑฺุณุจโูุง ูุงูุน ุงุณุช:

- ููุฏุงุฑ **ฑ** ูุดุงูโุฏููุฏูู ุชุทุงุจู ฺฉุงูู ุงุณุช.
- ููุฏุงุฑ ูุฒุฏฺฉ ุจู **ฐ** ุนู ุนููฺฉุฑุฏ ูุดุงุจู ุชุตุงุฏู ุงุณุช.
- ููุฏุงุฑ ููู ุนู ุนููฺฉุฑุฏ ุถุนูโุชุฑ ุงุฒ ุชุตุงุฏู.

---

## ุชุญูู ุฌุฏูู ูุชุงุฌ

- **blobs_3** โ ุชุนุฏุงุฏ ุฎูุดูโูุง ุฑุง ฺฉู ุจุดโุจุฑุขูุฑุฏ ฺฉุฑุฏู ุงุณุช (ต ุจูโุฌุง ณ) ุงูุง ุฏูุช ูุงุจูโูุจูู ุฏุงุฑุฏ (ARIโ0.875).
- **blobs_5** โ ุนููฺฉุฑุฏ ุนุงูุ ููุท ฺฉ ุฎูุดูู ุงุถุงู ุชุดุฎุต ุฏุงุฏู ุดุฏู ุงุณุช (ARIโ0.892).
- **moons** โ ุณุงุฎุชุงุฑ ุบุฑุฎุท ุจุงุนุซ ุฎุทุง ุฒุงุฏ ุฏุฑ ุชูฺฉฺฉ ุฎูุดูโูุง ุดุฏู (ARIโ0.22).
- **iris** โ ฺฉ ุงุฒ ุฎูุดูโูุง ุจุง ุฏฺฏุฑ ุงุฏุบุงู ุดุฏู ู ุชุนุฏุงุฏ ุชุฎููโุฒุฏูโุดุฏู ฺฉูุชุฑ ุงุณุช (ฒ ุจูโุฌุง ณ).

---

## ุชุญูู ฺฏุฑุงูฺฉ ูุชุงุฌ ุฎูุดูโุจูุฏ

### ูุฌููุนูโุฏุงุฏูู blobs_3

ุฏุฑ ุงู ุขุฒูุงุดุ ุณู ุฎูุดู ูุงูุน ุจุง ูพูุฌ ุฎูุดู ุชุฎููโุฒุฏูโุดุฏู ุชูุณุท UniForCE ููุงุณู ุดุฏูโุงูุฏ.  
ุงูฺฏูุฑุชู ุจุง ูุฌูุฏ ุจุดโุฎูุดูโุจูุฏุ ุณุงุฎุชุงุฑ ุงุตู ุฑุง ุจูโุฏุฑุณุช ุชุดุฎุต ุฏุงุฏู ู ูุฑุฒูุง ุฑุง ูุณุจุชุงู ุฎูุจ ุญูุธ ฺฉุฑุฏู ุงุณุช.  
ุฏูู ุงุฌุงุฏ ฺูุฏ ุฎูุดูู ุงุถุงูุ ูุฑุญููู **Overclustering** ุงููู ู ุฏูุช ูุญุฏูุฏ ุฏุฑ ุงุฏุบุงู ููุง ุฎูุดูโูุง ุงุณุช.

---

### ูุฌููุนูโุฏุงุฏูู blobs_5

ุฏุฑ ุฏุงุฏู ูพูุฌโุฎูุดูโุงุ UniForCE ุจุง ุฏูุช ุจุงูุง ุฎูุดูโูุง ุฑุง ุจุงุฒุงุจ ฺฉุฑุฏู ุงุณุช.  
ุชูุงูุช ุงูุฏฺฉ ุฏุฑ ARI (ฐ.89 ุฏุฑ ุจุฑุงุจุฑ ฐ.95) ูุดุงูโุฏููุฏูู ูุฒุฏฺฉ ุนููฺฉุฑุฏ ุจู KMeans ุงุณุชุ  
ุฏุฑ ุญุงู ฺฉู UniForCE **ุชุนุฏุงุฏ ูุงูุน ุฎูุดูโูุง ุฑุง ููโุฏุงูุณุช**.

## ูุฌููุนูโุฏุงุฏูู _iris_

ุฏุฑ ุขุฒูุงุด ุงูุฌุงูโุดุฏู ุฑู ุฏุงุฏูู **iris**ุ ุงูฺฏูุฑุชู UniForCE ุจุง ููุฏุงุฑ \( k = 2 \) ุจู ฺฉุงุฑ ฺฏุฑูุชู ุดุฏู ู ุดุงุฎุต ุดุจุงูุช **ARI = 0.558** ุจูโุฏุณุช ุขูุฏู ุงุณุชุ ุฏุฑ ุญุงูโฺฉู ุงูฺฏูุฑุชู KMeans ุจุง ุงุทูุงุน ุงุฒ ุชุนุฏุงุฏ ูุงูุน ุฎูุดูโูุง \( k = 3 \)ุ ููุฏุงุฑ **ARI = 0.716** ุฑุง ฺฉุณุจ ฺฉุฑุฏู ุงุณุช.

- **UniForCE** ุชูุงูุณุชู ุงุณุช ุฏู ุจุฎุด ุงุตู ุฏุงุฏู ุฑุง ุจูโุฎูุจ ุงุฒ ูู ุฌุฏุง ฺฉูุฏุ ฺฏุฑฺู ุจู ุฏูู ุงูุชุฎุงุจ \( k=2 \)ุ ฺฉ ฺฉูุงุณ ุงุฒ ุฏุงุฏูโูุง Iris ุจูโุตูุฑุช ุชุฑฺฉุจ ุดูุงุณุง ุดุฏู ุงุณุช.
- **KMeans** ุจุง ุฏุงูุณุชู ุชุนุฏุงุฏ ูุงูุน ุฎูุดูโูุง ุนููฺฉุฑุฏ ุฏููโุชุฑ ุฏุงุฑุฏ ู ุณู ฺฏุฑูู ูุณุจุชุงู ููุณุฌู ุฑุง ุจุงุฒุณุงุฒ ฺฉุฑุฏู ุงุณุช.
- ุชูุงูุช ุฏุฑ **ARI** ูุดุงู ูโุฏูุฏ ฺฉู UniForCE ุจุง ูุฌูุฏ ูุฏุงุดุชู ุงุทูุงุน ุงุฒ ุชุนุฏุงุฏ ุฎูุดูโูุงุ ุณุงุฎุชุงุฑ ฺฉู ุฏุงุฏู ุฑุง ุจูโุฏุฑุณุช ุจุงุฒููุง ฺฉุฑุฏู ู ุงุฒ ูุธุฑ ฺฉูุช ุชูฺฉฺฉุ ูุณุจุชุงู ูุฒุฏฺฉ ุจู KMeans ุนูู ฺฉุฑุฏู ุงุณุช.

---

## ูุฌููุนูโุฏุงุฏูู _moons_

ุฏุฑ ูุฌููุนูโุฏุงุฏูู **moons**ุ ุงูฺฏูุฑุชู UniForCE ุจุง ููุฏุงุฑ \( k = 10 \) ุงุฌุฑุง ุดุฏู ู ููุฏุงุฑ **ARI = 0.222** ุฑุง ุญุงุตู ฺฉุฑุฏู ุงุณุชุ ุฏุฑ ุญุงูโฺฉู KMeans ุจุง ุงุทูุงุน ุงุฒ ุชุนุฏุงุฏ ูุงูุน ุฎูุดูโูุงุ ููุฏุงุฑ **ARI = 0.247** ุฑุง ฺฉุณุจ ฺฉุฑุฏู ุงุณุช.

- **UniForCE** ุฏุฑ ุงู ุฏุงุฏูู ุบุฑุฎุท ุชูุงูุณุชู ุงุณุช ุณุงุฎุชุงุฑ ุฎูุฏูู ุฏู ููโูุงู ุฑุง ุชุง ุญุฏ ุดูุงุณุง ฺฉูุฏุ ุงูุง ุจูโุฏูู ุฎุงุตุช Overclustering ุงูููุ ุจุฎุดโูุง ุงุฒ ูุฑ ุฎูุดู ุฑุง ุจู ฺูุฏ ุฒุฑุฎูุดู ุชูุณู ฺฉุฑุฏู ุงุณุช.
- **KMeans** ูุฒ ุจูโุฏูู ูุฑุถ ุฎูุดูโูุง ฺฉุฑูุ ุฏุฑ ุฏุงุฏูโูุง ุบุฑุฎุท ุนููฺฉุฑุฏ ฺูุฏุงู ุจูุชุฑ ูุฏุงุฑุฏ ู ุจุฎุดโูุง ุงุฒ ุณุงุฎุชุงุฑ ุฑุง ุงุดุชุจุงู ุจุฑุขูุฑุฏ ูโฺฉูุฏ.
- ุงุฎุชูุงู ุงูุฏฺฉ ARI ุจู ุฏู ุฑูุด ูุดุงู ูโุฏูุฏ ฺฉู ูุฑ ุฏู ุฏุฑ ฺูู ุฏุงุฏูโูุง ุจุง ฺุงูุด ูุดุงุจู ุฑูุจูโุฑู ูุณุชูุฏ.

---

## ุฌูุนโุจูุฏ

| ูฺฺฏ                                            | ุชูุถุญ                                                     |
| ------------------------------------------------ | --------------------------------------------------------- |
| **ุชุฎูู ุฎูุฏฺฉุงุฑ k**                               | ูุงุฒ ุจู ุชุนู ุชุนุฏุงุฏ ุฎูุดูโูุง ูพุด ุงุฒ ุงุฌุฑุง ูุณุช.            |
| **ูพุงูโฺฏุฐุงุฑ ุขูุงุฑ ูุจุชู ุจุฑ ุชฺฉโูุฌู ุจูุฏู ุชูุฒุน** | ุจู ุฌุง ูุงุตููู ุงููุฏุณ ุตุฑูุ ุงุฒ ุชุญูู ฺฺฏุงู ุงุณุชูุงุฏู ูโฺฉูุฏ. |
| **ุนููฺฉุฑุฏ ูู ุฏุฑ ุฏุงุฏูโูุง ฺฏุงูุณ ู ุฎูุดโุณุงุฎุชุงุฑ**    | ุจูโูฺู ุฏุฑ ูุฌููุนูโูุง Blobs.                              |
| **ุถุนู ุฏุฑ ุณุงุฎุชุงุฑูุง ุบุฑุฎุท**                      | ุฏุฑ ุฏุงุฏูโูุง ุฎูุฏู (ูุซู Moons) ุนููฺฉุฑุฏ ฺฉุงูุด ูโุงุจุฏ.        |

---

## ูุชุฌูโฺฏุฑ ููุง

ุงูฺฏูุฑุชู **UniForCE** ฺฉ ฺุงุฑฺูุจ ูุจุชู ุจุฑ ุขุฒูููโูุง ฺฺฏุงู ุจุฑุง ุงุฏุบุงู ุฎูุดูโูุง ุงุณุช ฺฉู:

- ุจุฏูู ุงุทูุงุน ุงุฒ ุชุนุฏุงุฏ ุฎูุดูโูุง (`k`) ูุงุฏุฑ ุจู ุชุฎูู ุขู ุงุณุชุ
- ุฏุฑ ุฏุงุฏูโูุง ุฏุงุฑุง ุณุงุฎุชุงุฑ ฺฺฏุงู ูุงุถุญ ุนููฺฉุฑุฏ ูุฒุฏฺฉ ุจู KMeans ุฏุงุฑุฏุ
- ู ูโุชูุงูุฏ ุจู ุนููุงู ฺฏุงู ูุงู ุจุฑุง ุงูฺฏูุฑุชูโูุง ูพฺุฏูโุชุฑ (ูุงููุฏ HDBSCAN ุง Spectral Clustering) ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑุฏ.

---

## ููุงุจุน

1. **M. M. Hosseinzadeh, F. Mirjalili, M. S. Ghaemi, and A. Harifi**,  
   _"UniForCE: The Unimodality Forest method for Clustering and Estimation of the number of clusters"_,  
   published in **Information Sciences**, Elsevier, 2024.  
   ๐ <a href="https://www.sciencedirect.com/science/article/pii/" target ="_blank">ScienceDirect: UniForCE Article</a>
   
2. **GitHub Community**,  
   _"Clustering Algorithms โ open-source implementations and benchmarks"_,  
   2024.  
   ๐ [Clustering Algorithms on GitHub](https://github.com/topics/clustering-algorithms)

3. **M. M. Hosseinzadeh et al.**,  
   _"UniForCE: The Unimodality Forest method for Clustering and Estimation of the number of clusters"_,  
   Preprint available on **arXiv (2023)**.  
   ๐ [UniForCE on arXiv](https://arxiv.org/html/2312.11323v1)
